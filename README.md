
<!-- README.md is generated from README.Rmd. Please edit that file -->

FIHR
====

<!-- badges: start -->
<!-- badges: end -->

The goal of FIHR is to provide inference for linear and quadratic
functionals in high-dimensional linear and logistic regression models.
It computes bias-corrected estimators and corresponding standard errors
for the linear and quadratic functionals.

Installation
------------

You can install the development version from
[GitHub](https://github.com/) with:

    # install.packages("devtools")
    devtools::install_github("prabrishar1/FIHR")

Example
-------

These are basic examples which show how to solve the common
high-dimensional inference problems:

    library(FIHR)

Inference for linear functional in high-dimensional linear regression
model


    library(MASS)
    n = 100
    p = 400
    A1gen <- function(rho,p){
      A1=matrix(0,p,p)
      for(i in 1:p){
        for(j in 1:p){
          A1[i,j]<-rho^(abs(i-j))
        } 
      }
      A1
    }
    mu <- rep(0,p)
    mu[1:5] <- c(1:5)/5
    rho = 0.5
    Cov <- (A1gen(rho,p))/2
    Cov2<-matrix(NA,nrow=p,ncol=p)
    for(i in 1:p){
        for(j in 1:p){
        Cov2[i,j]<-0.5^(1+abs(i-j))
        } 
      }
    beta <- rep(0,p)
    beta[1:10] <- c(1:10)/5
    X <- MASS::mvrnorm(n,mu,Cov)
    y = X%*%beta + rnorm(n)
    loading <- MASS::mvrnorm(1,rep(0,p),Cov2)
    Est = FIHR::LF(X = X, y = y, loading = loading, intercept = TRUE)
    #> [1] 3
    #> [1] 3
    #> [1] 3
    #> [1] "step is 3"
    #> [1] "fixed mu"
    #> [1] 0.1542668
    Est$prop.est
    #>           [,1]
    #> [1,] -1.920388
    Est$se
    #> [1] 2.246184

Inference for linear functional in high-dimensional logistic regression
model

    library(MASS)
    A1gen <- function(rho,p){
      A1=matrix(0,p,p)
      for(i in 1:p){
        for(j in 1:p){
          A1[i,j]<-rho^(abs(i-j))
        } 
      }
      A1
    }
    n = 100
    p = 400
    mu <- rep(0,p)
    rho = 0.5
    Cov <- (A1gen(rho,p))/2
    Cov2<-matrix(NA,nrow=p,ncol=p)
    for(i in 1:p){
        for(j in 1:p){
        Cov2[i,j]<-0.5^(1+abs(i-j))
        } 
      }
    beta <- rep(0,p)
    beta[1:10] <- c(1:10)/5
    X <- MASS::mvrnorm(n,mu,Cov)
    exp_val <- X%*%beta
    prob <- exp(exp_val)/(1+exp(exp_val))
    y <- rbinom(n,1,prob)
    loading <- MASS::mvrnorm(1,mu,Cov2)
    Est = FIHR::LF_logistic(X = X, y = y, loading = loading, intercept = TRUE, weight = rep(1,n))
    #> [1] 3
    #> [1] 3
    #> [1] 3
    #> [1] "step is 3"
    #> [1] "fixed mu"
    #> [1] 0.1542668
    Est$prop.est
    #> [1] 0.7328738
    Est$se
    #> [1] 2.642197

Inference for quadratic functional in high-dimensional linear model


    library(MASS)
    A1gen <- function(rho,p){
      A1=matrix(0,p,p)
      for(i in 1:p){
        for(j in 1:p){
          A1[i,j]<-rho^(abs(i-j))
        } 
      }
      A1
    }
    rho = 0.6
    Cov <- (A1gen(rho,400))
    mu <- rep(0,400)
    mu[1:5] <- c(1:5)/5
    beta <- rep(0,400)
    beta[25:50] <- 0.08
    X <- MASS::mvrnorm(100,mu,Cov)
    y <- X%*%beta + rnorm(100)
    test.set <- c(30:100)

    ## Inference for Quadratic Functional with Population Covariance Matrix in middle

    Est = FIHR::QF(X = X, y = y, G=test.set)
    #> [1] 5
    #> [1] 5
    #> [1] 5
    #> [1] "fixed mu"
    #> [1] 0.1421723
    #> [1] "step is 5"
    Est$prop.est
    #>           [,1]
    #> [1,] 0.6090434
    Est$se
    #> [1] 0.1376886

    ## Inference for Quadratic Functional with known matrix A in middle

    Est = FIHR::QF(X = X, y = y, G=test.set, Cov.weight = FALSE,A = diag(1:400,400))
    #> [1] 5
    #> [1] 5
    #> [1] 5
    #> [1] "fixed mu"
    #> [1] 0.1421723
    #> [1] "step is 5"
    Est$prop.est
    #>          [,1]
    #> [1,] 23.91389
    Est$se
    #> [1] 2.722053

    ## Inference for square norm of regression vector

    Est = FIHR::QF(X = X, y = y, G=test.set, Cov.weight = FALSE,A = diag(1,400))
    #> [1] 4
    #> [1] 5
    #> [1] 4
    #> [1] "fixed mu"
    #> [1] 0.1777154
    #> [1] "step is 4"
    Est$prop.est
    #>           [,1]
    #> [1,] 0.3969596
    Est$se
    #> [1] 0.1024452

Finding Projection Direction in Linear Regression


    n = 100
    p = 400
    X = matrix(sample(-2:2,n*p,replace = TRUE),nrow = n,ncol = p)
    resol = 1.5
    step = 3

    ## Finding Projection Direction using fixed tuning parameter

    Direction.est <- FIHR::Direction_fixedtuning(X,loading=c(1,rep(0,(p-1))),mu=sqrt(2.01*log(p)/n)*resol^{-(step-1)})
    #> [1] "fixed mu"
    #> [1] 0.1542347
    Direction.est$proj
    #>   [1]  6.994979e-01  1.473896e-21  7.314740e-22 -2.324281e-21  1.387116e-21
    #>   [6]  9.608954e-22 -8.418673e-22 -5.256565e-22  2.234447e-21  4.874201e-02
    #>  [11]  2.199165e-21 -7.813217e-22  6.130995e-22 -1.121164e-21 -7.596861e-02
    #>  [16]  9.420117e-22 -3.862344e-22  1.866078e-21  2.137559e-21  1.583470e-21
    #>  [21]  4.618849e-21 -4.225047e-02  2.171534e-22 -6.701913e-22 -3.126297e-02
    #>  [26]  4.139467e-05  2.996181e-22 -1.820992e-22  9.547968e-22 -1.655104e-21
    #>  [31]  9.718422e-23 -4.276906e-22  4.676468e-22 -1.085322e-21  2.334506e-21
    #>  [36] -5.964304e-22 -2.229550e-21 -1.705679e-21 -7.975435e-22  1.202720e-22
    #>  [41] -1.058505e-21 -9.891116e-22 -2.151526e-21  2.342747e-23  1.717108e-21
    #>  [46]  4.685279e-22  1.640453e-21 -2.568350e-21  1.841063e-21 -1.512816e-21
    #>  [51]  3.549989e-22  1.657516e-21  3.253492e-03 -5.417448e-02  1.196257e-03
    #>  [56]  5.902004e-22 -2.088401e-21 -2.080762e-21 -2.566986e-03 -1.319932e-21
    #>  [61]  1.511005e-21  1.821590e-21  3.568038e-22 -1.319602e-21 -4.652523e-22
    #>  [66]  1.154010e-21  1.468592e-21 -2.228484e-21 -3.372236e-21  1.763717e-22
    #>  [71]  1.971515e-21 -1.860437e-21  1.267717e-21 -1.905469e-21 -2.769305e-21
    #>  [76] -8.957957e-23  8.872450e-02 -1.080192e-21  4.068212e-22 -1.637140e-21
    #>  [81]  1.436058e-21  4.262814e-22 -1.207828e-21  1.015078e-01 -1.928211e-22
    #>  [86]  1.273082e-21 -5.167818e-22 -1.080957e-21  5.921872e-22  8.097028e-22
    #>  [91]  1.223103e-22 -9.780226e-22 -1.277023e-21  1.564216e-21 -1.647563e-21
    #>  [96]  4.677617e-22 -4.046896e-02  7.580003e-22  4.348227e-22  1.479329e-21
    #> [101] -2.077221e-21  2.038162e-21  3.209655e-22  3.512906e-22 -5.781137e-22
    #> [106]  1.474851e-22 -1.062091e-21  8.514573e-22 -1.510036e-21  3.403871e-22
    #> [111]  2.973710e-21  1.871489e-21  3.431561e-22 -2.296018e-21 -2.707128e-21
    #> [116]  3.019799e-22  1.555452e-21  2.023915e-22 -1.174228e-21  8.481300e-22
    #> [121] -1.869841e-21 -5.674918e-22  6.290419e-23 -1.466466e-21 -2.512199e-21
    #> [126]  3.433652e-22  9.915652e-22 -1.267639e-21 -6.712585e-22  1.367029e-22
    #> [131] -9.654407e-22 -1.091281e-21 -2.043153e-22 -1.711645e-21 -8.130806e-22
    #> [136] -9.786022e-22  7.072738e-22 -3.591195e-02  1.774419e-22  2.157658e-21
    #> [141]  9.234098e-22 -2.081398e-21  1.416304e-21 -7.189399e-22  3.906106e-22
    #> [146]  1.341120e-21 -1.370639e-21 -1.809053e-21  9.343886e-22  2.706234e-23
    #> [151]  1.325823e-22  9.572578e-23  2.178994e-02  2.323174e-21  7.840942e-03
    #> [156] -2.212376e-23 -4.488350e-22  1.325482e-21 -5.484381e-22 -3.740495e-02
    #> [161] -2.707531e-02 -1.566205e-21  4.663363e-02  1.903645e-21  2.117916e-21
    #> [166]  3.998989e-22  6.370750e-22 -5.652301e-22  3.986752e-22 -1.375202e-21
    #> [171] -2.163947e-22  1.131891e-21 -4.943294e-22 -1.463050e-03  1.173560e-21
    #> [176]  1.250225e-02 -1.378315e-22  4.484511e-22  1.470780e-21  5.842593e-22
    #> [181] -1.665992e-22 -3.109320e-22  2.408816e-22 -1.719282e-21  8.158313e-22
    #> [186] -2.151875e-02  2.082649e-21 -2.538198e-21  1.333137e-22  9.739776e-22
    #> [191] -1.324242e-21 -8.975689e-22  6.682077e-22 -1.620455e-21  5.172843e-22
    #> [196] -2.244721e-23 -1.615784e-21 -5.336599e-22 -1.297653e-02 -1.209215e-21
    #> [201] -1.395940e-03 -8.528570e-22  3.751283e-22 -1.436482e-21  2.659586e-22
    #> [206]  1.510712e-21  3.558691e-23 -1.865446e-21  3.734478e-22 -1.004868e-21
    #> [211] -1.341116e-02 -3.588286e-22  4.059486e-22 -2.419156e-21  1.076428e-21
    #> [216]  7.886998e-22 -8.028678e-22  6.486914e-22 -2.019320e-21 -1.195066e-21
    #> [221] -9.878690e-22  1.340219e-21  4.262355e-22 -1.356514e-21 -1.226039e-21
    #> [226] -3.118292e-22  5.693747e-22 -8.205577e-22  1.176266e-22  2.265548e-21
    #> [231]  1.396361e-21 -5.715601e-23  9.442235e-22 -9.557223e-22  3.747572e-22
    #> [236] -1.389975e-22  2.802408e-22 -1.021565e-01 -3.888093e-22 -9.453249e-22
    #> [241] -7.091178e-22  1.698158e-02 -7.846894e-22 -1.353005e-21 -4.977710e-22
    #> [246]  2.488869e-21  1.031707e-21 -1.730227e-21 -2.754106e-22 -1.248272e-21
    #> [251]  2.627081e-26 -1.694242e-21 -2.921609e-22 -9.434738e-03  2.837911e-22
    #> [256]  1.298974e-21 -4.659840e-22 -7.615011e-22  1.171212e-21  4.872571e-22
    #> [261]  8.464005e-22  1.166691e-02  5.929460e-22 -1.704002e-21 -2.049393e-21
    #> [266] -1.698771e-21 -5.612093e-22  1.405544e-21 -7.144910e-22  5.831068e-22
    #> [271] -4.289758e-21 -3.056175e-22  2.034053e-21  2.741709e-22 -2.460227e-22
    #> [276]  5.776970e-02 -1.030407e-21  2.787333e-21  3.540230e-03 -5.794248e-22
    #> [281]  3.303187e-21  2.957905e-22 -1.997262e-21 -1.605448e-21 -1.043340e-21
    #> [286] -1.855330e-21 -1.741993e-21 -1.647867e-21  1.526282e-21  1.247806e-21
    #> [291]  2.939508e-22 -1.323922e-21  2.853520e-21  1.018951e-22 -1.997883e-22
    #> [296] -1.900876e-21 -1.220516e-21  5.358316e-22  6.530510e-22  1.479759e-21
    #> [301]  2.984358e-21  4.116652e-02 -1.757785e-21  1.445789e-21 -1.511598e-21
    #> [306] -4.397423e-22 -1.293815e-21 -4.037903e-22  6.070283e-23  1.312702e-21
    #> [311] -4.591143e-22 -1.810144e-21  6.823635e-22 -6.336940e-22 -1.757463e-21
    #> [316]  5.822062e-22 -1.555891e-21 -1.376295e-02 -1.267374e-22  1.575990e-21
    #> [321]  1.040440e-21  1.370129e-21 -7.368047e-22 -2.684535e-22  1.153204e-21
    #> [326]  8.624704e-22  5.016252e-22  3.379325e-23  8.950464e-22 -6.861468e-22
    #> [331]  1.035710e-21 -1.287129e-21  4.548832e-22  4.494884e-22 -5.364098e-22
    #> [336] -5.043482e-22  4.230838e-22 -2.343001e-21  6.521627e-22  8.948748e-02
    #> [341]  1.074864e-21  5.085382e-22 -1.387907e-21 -5.001084e-22 -4.607749e-22
    #> [346] -1.972014e-22  1.538948e-21 -1.479069e-21  1.723609e-21  1.662354e-21
    #> [351] -8.180055e-23 -1.592468e-21 -2.549864e-22 -2.603335e-22  1.627313e-21
    #> [356]  3.576052e-21 -8.294297e-22 -1.934353e-22  7.046068e-22  8.267398e-22
    #> [361]  1.170025e-21 -2.202664e-21 -1.077080e-21  1.013761e-21 -1.970279e-21
    #> [366]  9.669230e-22 -9.952548e-22 -1.523114e-21  2.054319e-21 -2.716601e-21
    #> [371] -1.486970e-21 -3.443438e-02 -1.936370e-22 -6.339163e-22  2.155516e-21
    #> [376] -1.437869e-21  6.916590e-22  2.948361e-02  9.313948e-22  2.881063e-21
    #> [381]  1.313528e-21 -1.959291e-21 -2.869275e-22 -1.707441e-21  9.212043e-22
    #> [386] -1.332369e-21  7.894869e-22  4.582445e-22 -1.923560e-21 -1.534481e-02
    #> [391] -1.964256e-21 -1.830185e-21 -2.314857e-21  9.063040e-22 -1.213379e-21
    #> [396] -1.832515e-21  1.584039e-21 -1.487077e-21 -1.583012e-21  9.379378e-22

    ## Finding Projection Direction using best step size

    Direction.est <- FIHR::Direction_searchtuning(X,loading=c(1,rep(0,(p-1))))
    #> [1] 3
    Direction.est$proj
    #>   [1]  6.994979e-01  1.466011e-21  7.131463e-22 -2.284381e-21  1.389083e-21
    #>   [6]  1.018248e-21 -8.972759e-22 -5.109079e-22  2.219141e-21  4.874201e-02
    #>  [11]  2.197153e-21 -8.019677e-22  6.557342e-22 -1.121948e-21 -7.596861e-02
    #>  [16]  9.579722e-22 -4.048011e-22  1.865208e-21  2.165248e-21  1.652711e-21
    #>  [21]  4.644961e-21 -4.225047e-02  2.239844e-22 -6.466220e-22 -3.126297e-02
    #>  [26]  4.139467e-05  2.535093e-22 -1.765887e-22  9.719231e-22 -1.658484e-21
    #>  [31]  6.161718e-23 -5.133655e-22  4.487360e-22 -1.082363e-21  2.339495e-21
    #>  [36] -5.975131e-22 -2.214833e-21 -1.703660e-21 -7.711404e-22  1.246743e-22
    #>  [41] -9.928065e-22 -1.015744e-21 -2.214030e-21  2.561159e-23  1.778338e-21
    #>  [46]  4.604306e-22  1.612358e-21 -2.625833e-21  1.833801e-21 -1.473954e-21
    #>  [51]  3.228298e-22  1.616674e-21  3.253492e-03 -5.417448e-02  1.196257e-03
    #>  [56]  5.707874e-22 -2.066191e-21 -2.173192e-21 -2.566986e-03 -1.273457e-21
    #>  [61]  1.486446e-21  1.823841e-21  3.202636e-22 -1.316437e-21 -5.016223e-22
    #>  [66]  1.164239e-21  1.420203e-21 -2.211173e-21 -3.366592e-21  1.316243e-22
    #>  [71]  2.016917e-21 -1.836648e-21  1.278295e-21 -1.972492e-21 -2.770526e-21
    #>  [76] -1.037368e-22  8.872450e-02 -1.107155e-21  4.075787e-22 -1.681235e-21
    #>  [81]  1.455474e-21  4.003153e-22 -1.207743e-21  1.015078e-01 -2.275758e-22
    #>  [86]  1.301385e-21 -5.205322e-22 -1.102904e-21  6.121941e-22  8.440410e-22
    #>  [91]  1.036998e-22 -9.891204e-22 -1.306335e-21  1.571128e-21 -1.623927e-21
    #>  [96]  4.547710e-22 -4.046896e-02  7.204775e-22  4.247036e-22  1.456109e-21
    #> [101] -2.072412e-21  2.062885e-21  2.670196e-22  3.312778e-22 -6.161858e-22
    #> [106]  1.801915e-22 -1.067066e-21  8.031295e-22 -1.546795e-21  3.994580e-22
    #> [111]  3.023095e-21  1.906561e-21  3.844432e-22 -2.337009e-21 -2.724480e-21
    #> [116]  3.127380e-22  1.546413e-21  2.061128e-22 -1.176305e-21  9.012172e-22
    #> [121] -1.862172e-21 -5.533942e-22  5.461105e-23 -1.467532e-21 -2.520054e-21
    #> [126]  3.514034e-22  1.018938e-21 -1.288291e-21 -6.551284e-22  1.509019e-22
    #> [131] -9.514380e-22 -1.106284e-21 -2.047943e-22 -1.738929e-21 -8.446036e-22
    #> [136] -9.743378e-22  6.510777e-22 -3.591195e-02  2.280045e-22  2.147481e-21
    #> [141]  9.216833e-22 -2.023959e-21  1.388779e-21 -7.318032e-22  3.873087e-22
    #> [146]  1.385358e-21 -1.360195e-21 -1.817394e-21  9.489258e-22  9.465950e-23
    #> [151]  1.379129e-22  1.044943e-22  2.178994e-02  2.368573e-21  7.840942e-03
    #> [156] -7.643463e-23 -4.439341e-22  1.306975e-21 -5.277521e-22 -3.740495e-02
    #> [161] -2.707531e-02 -1.549532e-21  4.663363e-02  1.923473e-21  2.075141e-21
    #> [166]  4.071047e-22  6.250255e-22 -5.863023e-22  3.382769e-22 -1.447057e-21
    #> [171] -2.046238e-22  1.213174e-21 -4.996036e-22 -1.463050e-03  1.151139e-21
    #> [176]  1.250225e-02 -1.560326e-22  3.929185e-22  1.476672e-21  5.573799e-22
    #> [181] -1.765411e-22 -3.250862e-22  2.017408e-22 -1.697529e-21  8.191682e-22
    #> [186] -2.151875e-02  2.054556e-21 -2.548332e-21  1.432835e-22  9.724244e-22
    #> [191] -1.323040e-21 -8.845076e-22  6.257799e-22 -1.584028e-21  5.521815e-22
    #> [196]  1.349637e-23 -1.606588e-21 -5.300653e-22 -1.297653e-02 -1.196229e-21
    #> [201] -1.395940e-03 -8.341459e-22  3.899822e-22 -1.475131e-21  2.457824e-22
    #> [206]  1.499574e-21  9.337480e-23 -1.913186e-21  3.859161e-22 -9.771011e-22
    #> [211] -1.341116e-02 -3.485371e-22  4.131474e-22 -2.453059e-21  1.070234e-21
    #> [216]  7.775748e-22 -7.832318e-22  6.868150e-22 -2.019502e-21 -1.265883e-21
    #> [221] -9.631204e-22  1.368390e-21  4.250054e-22 -1.345598e-21 -1.197843e-21
    #> [226] -3.599379e-22  6.223651e-22 -7.945381e-22  1.088905e-22  2.284529e-21
    #> [231]  1.388512e-21 -8.361059e-23  9.302896e-22 -9.608826e-22  3.721902e-22
    #> [236] -1.579849e-22  3.298321e-22 -1.021565e-01 -3.906142e-22 -9.522072e-22
    #> [241] -6.971588e-22  1.698158e-02 -7.843344e-22 -1.395786e-21 -5.165792e-22
    #> [246]  2.518459e-21  1.034217e-21 -1.761623e-21 -2.591224e-22 -1.288015e-21
    #> [251]  2.330973e-23 -1.687093e-21 -2.831511e-22 -9.434738e-03  3.258996e-22
    #> [256]  1.350064e-21 -4.334643e-22 -7.780657e-22  1.251634e-21  4.718087e-22
    #> [261]  8.309464e-22  1.166691e-02  5.777577e-22 -1.661720e-21 -2.046559e-21
    #> [266] -1.713441e-21 -6.066588e-22  1.429411e-21 -7.329095e-22  5.545751e-22
    #> [271] -4.322368e-21 -3.440302e-22  2.076653e-21  2.480440e-22 -2.428399e-22
    #> [276]  5.776970e-02 -1.033482e-21  2.771914e-21  3.540230e-03 -6.333909e-22
    #> [281]  3.378575e-21  3.415361e-22 -1.984407e-21 -1.642640e-21 -1.037657e-21
    #> [286] -1.844308e-21 -1.746215e-21 -1.664781e-21  1.523120e-21  1.298590e-21
    #> [291]  2.965576e-22 -1.260115e-21  2.873531e-21  8.412670e-23 -2.144728e-22
    #> [296] -1.951498e-21 -1.247445e-21  5.276391e-22  6.813983e-22  1.510950e-21
    #> [301]  3.070087e-21  4.116652e-02 -1.781833e-21  1.429734e-21 -1.512301e-21
    #> [306] -4.424351e-22 -1.260241e-21 -4.338890e-22 -4.060266e-24  1.265089e-21
    #> [311] -4.828745e-22 -1.896128e-21  6.937695e-22 -6.556199e-22 -1.780623e-21
    #> [316]  6.059800e-22 -1.532800e-21 -1.376295e-02 -1.209736e-22  1.658534e-21
    #> [321]  1.070546e-21  1.311178e-21 -7.287094e-22 -3.092785e-22  1.200675e-21
    #> [326]  8.589333e-22  5.151827e-22  3.107497e-23  8.746812e-22 -6.806372e-22
    #> [331]  1.039553e-21 -1.320311e-21  4.581080e-22  4.683321e-22 -5.627710e-22
    #> [336] -4.888621e-22  4.486180e-22 -2.371168e-21  6.624540e-22  8.948748e-02
    #> [341]  1.094217e-21  5.010034e-22 -1.449493e-21 -4.331457e-22 -4.589690e-22
    #> [346] -1.855836e-22  1.536297e-21 -1.540590e-21  1.717215e-21  1.633315e-21
    #> [351] -4.583414e-23 -1.605092e-21 -2.704726e-22 -2.487333e-22  1.613760e-21
    #> [356]  3.636015e-21 -8.633084e-22 -2.422728e-22  7.165717e-22  8.175015e-22
    #> [361]  1.199400e-21 -2.247411e-21 -1.135189e-21  1.016758e-21 -1.980565e-21
    #> [366]  9.896443e-22 -9.948481e-22 -1.516157e-21  2.089609e-21 -2.774896e-21
    #> [371] -1.450055e-21 -3.443438e-02 -1.873800e-22 -6.311894e-22  2.144733e-21
    #> [376] -1.414825e-21  6.652166e-22  2.948361e-02  9.525075e-22  2.851259e-21
    #> [381]  1.315727e-21 -1.998270e-21 -2.976005e-22 -1.686773e-21  9.069051e-22
    #> [386] -1.289891e-21  8.096615e-22  4.459980e-22 -1.908456e-21 -1.534481e-02
    #> [391] -1.987370e-21 -1.871050e-21 -2.327709e-21  8.672020e-22 -1.245952e-21
    #> [396] -1.822965e-21  1.553937e-21 -1.507097e-21 -1.639830e-21  9.304763e-22

Finding Projection Direction in Logistic Regression


    n = 50
    p = 400
    X = matrix(sample(-2:2,n*p,replace = TRUE),nrow=n,ncol=p)
    y = rbinom(n,1,0.5)
    col.norm <- 1/sqrt((1/n)*diag(t(X)%*%X)+0.0001);
    Xnor <- X %*% diag(col.norm);
    fit = glmnet::cv.glmnet(Xnor, y, alpha=1,family = "binomial")
    htheta <- as.vector(coef(fit, s = "lambda.min"))
    support<-(abs(htheta)>0.001)
    Xb <- cbind(rep(1,n),Xnor);
    Xc <- cbind(rep(1,n),X);
    col.norm <- c(1,col.norm);
    pp <- (p+1);
    xnew = c(1,rep(0,(p-1)))
    loading=rep(0,pp)
    loading[1]=1
    loading[-1]=xnew
    htheta <- htheta*col.norm;
    htheta <- as.vector(htheta)
    f_prime <- exp(Xc%*%htheta)/(1+exp(Xc%*%htheta))^2

    ## Finding Projection Direction using fixed tuning parameter

    Direction.est <- FIHR::Direction_fixedtuning(X,loading=c(1,rep(0,(p-1))),mu=sqrt(2.01*log(p)/n)*resol^{-(step-1)},model = "logistic",weight = 1/f_prime, deriv.vec = f_prime)
    #> [1] "fixed mu"
    #> [1] 0.2181208
    Direction.est$proj
    #>   [1]  1.283411e+00  1.293485e-20  1.053499e-19  5.674529e-20 -5.347360e-20
    #>   [6]  1.617380e-20  1.374205e-21 -7.364633e-21  1.955335e-20  7.042033e-20
    #>  [11]  1.524580e-20  1.349116e-20 -6.033970e-20  3.447775e-20 -4.090555e-20
    #>  [16]  1.725752e-20 -7.302497e-02 -3.906988e-20 -5.152975e-20  3.096834e-20
    #>  [21] -2.122678e-21 -8.403344e-21  2.601538e-20  3.883874e-21  7.484977e-21
    #>  [26]  6.715521e-21 -2.880070e-20 -6.101812e-20 -8.666937e-20 -2.289592e-20
    #>  [31]  5.129117e-20 -2.422835e-20  7.352284e-20  3.019471e-20  1.063606e-20
    #>  [36]  4.771406e-20  2.078890e-01 -2.142578e-04 -7.522795e-21  4.609122e-20
    #>  [41]  1.148901e-20 -3.275713e-20  2.279681e-20 -4.358918e-21  5.941016e-04
    #>  [46] -3.782306e-20 -1.918487e-01 -3.467331e-20  9.246597e-21  4.692331e-20
    #>  [51] -5.938425e-21 -4.864265e-20 -1.755110e-20 -2.638555e-20 -5.941173e-20
    #>  [56] -4.559768e-20 -6.169138e-20  3.863916e-22 -3.747412e-02 -1.974216e-01
    #>  [61] -6.820154e-20  2.365940e-20  2.831276e-21 -3.909393e-21  1.760636e-20
    #>  [66] -3.783237e-20  4.844188e-21 -2.140812e-20  1.677411e-20  2.930633e-20
    #>  [71] -5.446811e-21  5.226138e-21 -2.869757e-20 -4.248746e-20 -8.466266e-21
    #>  [76]  3.367773e-21  4.427166e-20  2.892583e-02  2.278522e-21  7.727094e-20
    #>  [81]  1.975774e-20  2.822548e-20  3.262956e-20 -2.822030e-20 -7.927124e-21
    #>  [86]  2.382685e-20  1.891291e-20  5.954417e-20 -5.050814e-21  5.083679e-20
    #>  [91] -3.827247e-20 -4.368393e-20 -3.272886e-20 -5.011944e-20 -5.010123e-20
    #>  [96]  4.261748e-20  2.271164e-20 -3.977673e-20 -6.319483e-20  2.765566e-20
    #> [101]  2.714532e-20 -4.425999e-20 -1.847478e-20  4.030705e-20  2.872498e-02
    #> [106] -3.606319e-20 -4.051364e-20 -4.216385e-20 -1.815365e-20  1.061533e-20
    #> [111] -5.773947e-20 -2.784439e-20 -1.783786e-20 -5.876155e-20 -1.118931e-20
    #> [116] -2.097015e-03 -5.549260e-02  1.333212e-20 -2.790972e-21  8.826832e-21
    #> [121]  4.445133e-21  4.590611e-20  2.433346e-20  7.740324e-21 -3.967014e-02
    #> [126]  2.405205e-20 -1.101264e-20 -3.335579e-20 -3.731630e-20 -4.459454e-20
    #> [131] -7.526517e-21  2.443672e-20 -2.391813e-20  2.219114e-21 -1.925264e-20
    #> [136]  6.268475e-20 -1.097806e-21 -7.347591e-02  1.734722e-20  1.278042e-20
    #> [141] -6.346966e-20 -3.940048e-20  1.730797e-20 -5.616823e-20  3.336397e-23
    #> [146]  5.397176e-20  5.740737e-20  1.094551e-19 -4.072046e-20  1.552411e-20
    #> [151]  4.117363e-20  7.789642e-21 -3.183760e-20  8.357615e-21 -5.659085e-20
    #> [156] -3.929191e-22  4.861289e-20 -3.025248e-20 -3.694041e-20  1.178084e-20
    #> [161] -5.397231e-21 -1.663259e-20  2.362875e-20 -7.449503e-20 -3.009184e-20
    #> [166]  4.044533e-20  6.322146e-20 -3.064029e-20  8.186057e-21 -5.131333e-21
    #> [171]  3.165814e-20 -3.345878e-20 -4.895372e-20  2.187942e-20  2.397427e-20
    #> [176]  2.212062e-20  8.352855e-21 -3.107123e-20 -1.445464e-01 -4.987659e-20
    #> [181] -1.226711e-20  6.925021e-20 -1.430298e-20  4.092213e-02 -1.423515e-20
    #> [186]  4.117483e-20 -2.613580e-01  2.363685e-20  1.273214e-20  4.466229e-20
    #> [191] -1.006207e-20  2.196154e-20 -7.840332e-22 -1.126004e-01  3.316913e-20
    #> [196] -3.544607e-20 -9.655411e-21 -7.557470e-20 -5.287067e-20 -7.002458e-21
    #> [201]  8.346334e-21  7.037785e-21 -1.229374e-19  2.272894e-02  3.886174e-02
    #> [206]  1.167734e-20  2.778319e-20 -2.746034e-20 -1.791456e-20  1.549220e-20
    #> [211]  2.402494e-20 -2.201497e-20  3.973477e-20  9.930197e-22 -2.493676e-20
    #> [216] -5.487120e-20 -5.479543e-20  3.326965e-20  5.566583e-21 -4.813702e-21
    #> [221] -4.150270e-20  8.169924e-20  4.713052e-20 -1.155383e-19 -1.028045e-19
    #> [226]  4.686098e-20 -3.444966e-20 -5.041448e-20 -7.731806e-20 -1.313958e-20
    #> [231]  3.453921e-20  1.721983e-20 -3.072342e-20  1.537119e-21 -3.263597e-20
    #> [236]  3.352210e-03  1.172121e-01 -4.462954e-20 -3.929521e-21  5.037955e-20
    #> [241]  1.423879e-20  1.609904e-20 -2.109287e-20  2.529613e-20  6.347150e-21
    #> [246]  3.159820e-20  3.252396e-20  2.087765e-21  1.897956e-20 -1.292227e-20
    #> [251] -7.349689e-20  3.091914e-20  2.396138e-20  5.383305e-20  1.270433e-20
    #> [256] -6.714081e-20  3.603421e-20  8.713602e-21 -4.353162e-03 -3.774891e-20
    #> [261]  5.265757e-20 -6.059078e-21 -6.172810e-21 -8.637597e-22 -4.687949e-20
    #> [266] -2.669537e-02 -1.805000e-20 -1.497956e-01 -2.411393e-20 -4.076239e-02
    #> [271]  4.149878e-20 -7.534412e-21 -4.520060e-20  1.070835e-21 -8.128977e-21
    #> [276]  6.508338e-21 -1.231988e-20 -7.693984e-21 -3.025650e-20 -1.737757e-02
    #> [281] -2.866371e-20 -1.101643e-20 -1.040211e-19  2.452936e-20  1.448797e-20
    #> [286] -7.376027e-20  2.130241e-20  2.282006e-20 -1.937338e-20 -1.575376e-20
    #> [291] -3.758127e-20  1.402451e-20 -6.299529e-21  4.786832e-21 -9.451638e-21
    #> [296] -2.669638e-20  4.637151e-21  3.266475e-20  2.182759e-20 -6.512317e-20
    #> [301]  3.188309e-20 -4.653427e-20 -1.441595e-20 -2.037388e-20 -2.066957e-21
    #> [306] -3.023228e-20  1.137256e-02 -1.490939e-20  4.404865e-20  2.558968e-20
    #> [311]  6.362115e-20 -3.965178e-20  2.204319e-20 -4.264628e-20 -2.311671e-20
    #> [316]  4.554730e-20 -3.170721e-20  5.519662e-20  1.836176e-20  7.248755e-21
    #> [321] -1.235297e-20  8.352364e-21  7.724915e-20  1.763304e-20 -2.159544e-20
    #> [326] -4.497632e-20  4.810341e-21 -5.869764e-21 -1.870597e-20  1.109413e-20
    #> [331] -4.868695e-20  1.012289e-21  2.944166e-21  2.248758e-20  1.302020e-20
    #> [336] -3.141661e-20 -8.668111e-21 -3.653824e-20 -2.330343e-20 -2.546303e-01
    #> [341]  3.620428e-20  3.064627e-20 -3.666828e-20 -7.151369e-20  4.033278e-02
    #> [346]  7.569914e-20  2.168002e-20  2.489226e-20  4.068871e-21  2.950307e-20
    #> [351]  1.334536e-01 -3.367731e-21 -2.536512e-21 -6.790609e-21  2.544031e-20
    #> [356] -2.611149e-21 -5.038431e-20 -4.320352e-20  4.772762e-20 -6.687500e-20
    #> [361]  7.793678e-22 -8.857914e-20  2.938601e-20 -6.749791e-20  1.468454e-01
    #> [366] -1.392515e-20  4.865683e-03  5.493905e-21  2.365605e-20  6.230391e-20
    #> [371]  4.361884e-20  1.910145e-20  1.686998e-02  2.298684e-20  2.637964e-20
    #> [376] -9.051841e-21 -4.020992e-20 -6.955482e-21 -4.396248e-20  1.713925e-20
    #> [381]  4.523053e-20  5.166597e-20  1.034975e-19 -6.580215e-21 -2.298329e-20
    #> [386] -7.659744e-21  3.472796e-20 -1.663896e-20  1.946221e-20 -3.094951e-20
    #> [391] -2.575064e-20  4.439966e-20  7.104025e-02 -7.282205e-21  2.211797e-01
    #> [396] -3.839553e-20  1.223485e-20  2.773033e-20  7.930536e-20 -1.075272e-20

    ## Finding Projection Direction using best step size


    Direction.est <- FIHR::Direction_searchtuning(Xc,loading,model = "logistic",weight = 1/f_prime, deriv.vec = f_prime)
    #> [1] 2
    Direction.est$proj
    #>   [1]  4.459317e-01  3.303710e-01  3.718785e-23 -3.542110e-22  2.555173e-23
    #>   [6] -3.513278e-23 -2.981491e-22 -4.267184e-23  1.840581e-22 -4.596626e-22
    #>  [11] -2.341205e-22 -1.512517e-22 -1.340602e-23  4.710844e-23  1.045119e-22
    #>  [16]  3.769097e-22  2.029714e-22 -2.149735e-22 -1.396011e-22 -3.637638e-22
    #>  [21]  2.603526e-25  3.757097e-22 -1.187945e-22 -2.578368e-22  3.176746e-24
    #>  [26]  2.299347e-22  1.452758e-22 -2.318806e-22  1.046251e-22 -7.368008e-23
    #>  [31]  1.728362e-22  2.779633e-22  5.196758e-23  2.904219e-23 -1.033057e-22
    #>  [36]  4.242822e-23  3.666376e-22  6.729824e-22 -2.981451e-22 -1.944492e-22
    #>  [41] -1.922724e-22 -8.295588e-23  3.029703e-22  1.848699e-22 -2.996521e-22
    #>  [46]  4.232438e-22 -1.332758e-22 -3.026109e-22 -2.482077e-22 -3.587143e-22
    #>  [51]  3.457959e-23  4.268315e-23  3.832221e-22  5.231971e-22  2.029503e-22
    #>  [56] -3.691746e-24  1.189839e-23  1.864115e-22 -1.540669e-22 -5.270189e-22
    #>  [61] -4.011415e-22 -1.673996e-22  2.055704e-22 -9.582353e-23 -3.555349e-22
    #>  [66] -1.475175e-22  3.318677e-24  3.143909e-23 -2.976996e-22  2.771296e-22
    #>  [71]  3.883634e-22 -1.218059e-23  1.972215e-23 -5.218498e-22  5.674755e-23
    #>  [76] -8.912485e-23 -1.371074e-22  6.708495e-23  4.606899e-22  2.979208e-22
    #>  [81]  1.501972e-23 -1.155708e-22  3.028271e-22  2.045919e-22 -1.426316e-22
    #>  [86] -2.445916e-22 -2.444326e-22 -2.379612e-22 -2.741793e-22 -2.924095e-22
    #>  [91] -2.580042e-22  4.467659e-22 -3.617817e-22 -1.805680e-23 -2.218341e-22
    #>  [96]  2.941030e-22 -2.653037e-22 -2.265138e-23  2.274303e-22 -5.460550e-22
    #> [101]  5.446277e-23 -1.204521e-22  6.457619e-24 -3.414791e-22  3.104789e-24
    #> [106]  3.662833e-22  8.568819e-23  7.269162e-23 -1.569708e-22  2.456551e-22
    #> [111] -3.179715e-23 -4.593777e-22 -2.565909e-22  4.027145e-22  5.038337e-22
    #> [116] -1.604776e-22 -4.704397e-22 -2.791651e-22 -1.090137e-22 -1.107550e-22
    #> [121] -2.617841e-22  1.900346e-22 -6.707824e-23 -4.543747e-22 -8.876725e-23
    #> [126] -3.369308e-22 -1.990772e-22 -2.115677e-22 -1.137581e-22 -1.919398e-22
    #> [131]  9.339076e-23  1.148486e-22 -1.977510e-22 -9.476433e-23  1.077674e-22
    #> [136]  3.569239e-23 -9.135486e-24  2.005456e-22 -3.001696e-22  1.417904e-22
    #> [141] -9.099401e-23 -2.948450e-22 -8.771013e-23 -7.775965e-24 -7.968221e-23
    #> [146] -3.547446e-23  1.102820e-22 -3.087164e-22  1.311350e-23 -7.459927e-23
    #> [151]  1.794814e-22 -5.650170e-23 -1.465365e-22  8.555206e-23 -2.810931e-23
    #> [156]  1.968422e-22 -1.807577e-22  1.968436e-22 -2.691972e-22 -3.027647e-23
    #> [161] -9.200731e-23  1.529935e-22 -1.523137e-22 -6.230396e-22  2.573963e-22
    #> [166] -3.588380e-22 -3.778638e-22  3.869022e-23 -9.961249e-23  3.456020e-24
    #> [171]  1.832658e-22  2.815599e-22 -1.703917e-22 -1.385076e-22  3.557362e-22
    #> [176] -3.791442e-22  2.274467e-22 -1.848517e-22 -2.090245e-22 -5.160467e-22
    #> [181]  2.142879e-22  9.090737e-23 -1.501737e-22  9.187914e-23  2.299295e-22
    #> [186] -4.961159e-23 -1.150202e-22 -4.797473e-22 -2.348739e-22  2.974224e-22
    #> [191]  1.809289e-23 -2.861005e-22  6.616996e-23  3.556154e-22 -5.086601e-22
    #> [196] -4.311732e-23 -1.904620e-23  1.576254e-22  1.213539e-22  7.182271e-23
    #> [201] -4.279453e-22  5.268839e-23  3.019161e-22 -6.564283e-23  2.971990e-22
    #> [206]  3.700883e-22  3.503321e-23  8.613147e-23 -2.352414e-22  7.292717e-23
    #> [211] -1.321514e-22  2.194126e-22 -1.447056e-23  2.181841e-22 -1.326350e-22
    #> [216] -2.530346e-22 -3.645407e-22 -1.290810e-22  1.611930e-22  1.077287e-22
    #> [221] -1.688770e-22  1.001705e-22 -2.326115e-23  3.496908e-23  6.064505e-23
    #> [226] -1.150138e-22 -3.033643e-22 -4.395290e-22  3.561864e-22 -1.552169e-22
    #> [231]  2.208311e-23 -9.746945e-23 -5.219017e-22 -1.575376e-22 -2.231925e-22
    #> [236] -1.140698e-22  2.824007e-22  4.861132e-22  6.190032e-22 -1.105004e-22
    #> [241]  1.337159e-22 -5.313538e-24  2.330488e-22 -5.005548e-23 -1.238670e-24
    #> [246]  8.751917e-23 -1.473823e-22 -1.879762e-22 -1.122473e-22 -1.228222e-22
    #> [251]  2.634276e-22 -8.156392e-23 -1.302387e-22  4.472210e-23  2.048640e-22
    #> [256]  9.341365e-23  6.755147e-23 -1.672059e-22 -2.895006e-22 -2.647385e-22
    #> [261] -1.697851e-22 -1.243682e-22  1.643547e-22  7.229198e-23 -1.753508e-22
    #> [266]  2.552771e-23 -2.254638e-22 -9.278325e-23 -4.361228e-22 -1.118427e-22
    #> [271] -3.515063e-22  2.548174e-22 -2.090649e-22  1.587349e-22 -1.238818e-22
    #> [276]  3.822346e-22 -8.663075e-23  9.551185e-23  6.973228e-23  1.874518e-22
    #> [281] -4.321109e-22 -1.306071e-22 -2.212683e-22  6.151830e-25 -2.507666e-22
    #> [286]  3.428438e-22  4.088720e-25 -1.747781e-22  4.872125e-23  5.450330e-23
    #> [291] -6.408973e-23 -1.237889e-22 -2.860652e-23 -1.880944e-22  2.125410e-23
    #> [296]  1.792766e-22 -1.291089e-22  1.425234e-22  2.241634e-23 -2.444526e-23
    #> [301]  1.918863e-22 -8.211422e-23  2.718425e-23  5.848287e-23  2.312751e-22
    #> [306] -1.973266e-22  1.400779e-22  5.404383e-22  1.133229e-22 -3.078384e-22
    #> [311]  9.773867e-23  5.162767e-23 -1.002633e-22 -2.010304e-22  3.021764e-22
    #> [316]  2.694740e-22  3.117438e-22  6.104867e-23 -2.629048e-22  3.501231e-22
    #> [321] -1.958474e-22 -4.076983e-23  2.191294e-22 -1.872724e-22  1.589907e-23
    #> [326] -3.333901e-22 -3.127594e-22  8.181983e-23 -1.815484e-22 -9.991372e-23
    #> [331] -4.920590e-23 -1.286211e-22  2.535792e-22 -2.225180e-22 -8.925771e-23
    #> [336]  1.957897e-22 -1.351767e-23 -7.468701e-23  8.607770e-23  3.285857e-22
    #> [341] -5.618192e-22  4.082522e-22  8.550624e-23  3.218437e-22 -1.446554e-22
    #> [346]  2.689099e-22 -8.521205e-23 -3.068099e-22 -2.232187e-23 -8.218642e-23
    #> [351]  2.209305e-23  4.424912e-22  3.099446e-22  1.180333e-23 -4.919464e-23
    #> [356] -2.265383e-22  9.453924e-23  4.505170e-22 -2.718215e-22  1.573370e-22
    #> [361]  8.937041e-23 -3.659173e-22 -1.009509e-22 -1.057698e-22  3.118442e-22
    #> [366]  4.623206e-22  9.624067e-23  5.710347e-22 -2.465390e-24 -1.278873e-22
    #> [371] -2.358346e-22 -3.366305e-22 -2.559346e-22  4.777267e-22 -2.698103e-22
    #> [376]  2.305964e-24  4.422132e-22  7.261683e-23  1.943675e-22  3.568833e-22
    #> [381]  6.969868e-23 -1.749189e-22 -1.618785e-23 -5.989205e-23  2.710556e-23
    #> [386]  1.568296e-22 -1.505126e-22  1.226671e-25 -2.630443e-22  2.926890e-22
    #> [391]  2.266299e-22 -1.851697e-22 -2.459961e-22  4.389237e-22 -3.810690e-22
    #> [396]  6.433289e-22 -6.212710e-23 -1.500785e-22  1.081759e-22  2.371878e-22
    #> [401] -1.428187e-22
