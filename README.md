
<!-- README.md is generated from README.Rmd. Please edit that file -->

FIHR
====

<!-- badges: start -->
<!-- badges: end -->

The goal of FIHR is to provide inference for linear and quadratic
functionals in high-dimensional linear and logistic regression models.
It computes bias-corrected estimators and corresponding standard errors
for the linear and quadratic functionals.

Installation
------------

You can install the development version from
[GitHub](https://github.com/) with:

    # install.packages("devtools")
    devtools::install_github("prabrishar1/FIHR")

Example
-------

These are basic examples which show how to solve the common
high-dimensional inference problems:

    library(FIHR)

Inference for linear functional in high-dimensional linear regression
model


    library(MASS)
    n = 100
    p = 400
    A1gen <- function(rho,p){
      A1=matrix(0,p,p)
      for(i in 1:p){
        for(j in 1:p){
          A1[i,j]<-rho^(abs(i-j))
        } 
      }
      A1
    }
    mu <- rep(0,p)
    mu[1:5] <- c(1:5)/5
    rho = 0.5
    Cov <- (A1gen(rho,p))/2
    Cov2<-matrix(NA,nrow=p,ncol=p)
    for(i in 1:p){
        for(j in 1:p){
        Cov2[i,j]<-0.5^(1+abs(i-j))
        } 
      }
    beta <- rep(0,p)
    beta[1:10] <- c(1:10)/5
    X <- MASS::mvrnorm(n,mu,Cov)
    y = X%*%beta + rnorm(n)
    loading <- MASS::mvrnorm(1,rep(0,p),Cov2)
    Est = FIHR::LF(X = X, y = y, loading = loading, intercept = TRUE)
    #> [1] 3
    #> [1] "step is 3"
    Est$prop.est
    #>          [,1]
    #> [1,] 1.015329
    Est$se
    #> [1] 0.9411583

Inference for linear functional in high-dimensional logistic regression
model

    library(MASS)
    A1gen <- function(rho,p){
      A1=matrix(0,p,p)
      for(i in 1:p){
        for(j in 1:p){
          A1[i,j]<-rho^(abs(i-j))
        } 
      }
      A1
    }
    n = 100
    p = 400
    mu <- rep(0,p)
    rho = 0.5
    Cov <- (A1gen(rho,p))/2
    Cov2<-matrix(NA,nrow=p,ncol=p)
    for(i in 1:p){
        for(j in 1:p){
        Cov2[i,j]<-0.5^(1+abs(i-j))
        } 
      }
    beta <- rep(0,p)
    beta[1:10] <- c(1:10)/5
    X <- MASS::mvrnorm(n,mu,Cov)
    exp_val <- X%*%beta
    prob <- exp(exp_val)/(1+exp(exp_val))
    y <- rbinom(n,1,prob)
    loading <- MASS::mvrnorm(1,mu,Cov2)
    Est = FIHR::LF_logistic(X = X, y = y, loading = loading, intercept = TRUE, weight = rep(1,n))
    #> Warning in htheta * col.norm: longer object length is not a multiple of shorter
    #> object length
    #> [1] 3
    #> [1] "step is 3"
    Est$prop.est
    #> [1] -0.3832133
    Est$se
    #> [1] 2.947321

Inference for quadratic functional in high-dimensional linear model


    library(MASS)
    A1gen <- function(rho,p){
      A1=matrix(0,p,p)
      for(i in 1:p){
        for(j in 1:p){
          A1[i,j]<-rho^(abs(i-j))
        } 
      }
      A1
    }
    rho = 0.6
    Cov <- (A1gen(rho,400))
    mu <- rep(0,400)
    mu[1:5] <- c(1:5)/5
    beta <- rep(0,400)
    beta[25:50] <- 0.08
    X <- MASS::mvrnorm(100,mu,Cov)
    y <- X%*%beta + rnorm(100)
    test.set <- c(30:100)

    ## Inference for Quadratic Functional with Population Covariance Matrix in middle

    Est = FIHR::QF(X = X, y = y, G=test.set)
    Est$prop.est
    #>           [,1]
    #> [1,] 0.4610891
    Est$se
    #> [1] 0.1122266

    ## Inference for Quadratic Functional with known matrix A in middle

    Est = FIHR::QF(X = X, y = y, G=test.set, Cov.weight = FALSE,A = diag(1:400,400))
    Est$prop.est
    #>          [,1]
    #> [1,] 9.517339
    Est$se
    #> [1] 0.489694

    ## Inference for square norm of regression vector

    Est = FIHR::QF(X = X, y = y, G=test.set, Cov.weight = FALSE,A = diag(1,400))
    Est$prop.est
    #>           [,1]
    #> [1,] 0.5347911
    Est$se
    #> [1] 0.1415355

Finding Projection Direction in Linear Regression


    n = 100
    p = 400
    X = matrix(sample(-2:2,n*p,replace = TRUE),nrow = n,ncol = p)
    resol = 1.5
    step = 3

    ## Finding Projection Direction using fixed tuning parameter

    Direction.est <- FIHR::Direction_fixedtuning(X,loading=c(1,rep(0,(p-1))),mu=sqrt(2.01*log(p)/n)*resol^{-(step-1)})
    #> [1] "fixed mu"
    #> [1] 0.1542347
    Direction.est$proj
    #>   [1]  5.554458e-01 -2.642760e-22 -3.069293e-22 -9.944103e-22  3.900489e-22
    #>   [6] -2.627730e-02  3.295492e-22  2.333681e-22 -4.867091e-22  7.251174e-22
    #>  [11]  3.753091e-22 -2.334957e-22 -1.037591e-21  5.142206e-22  2.350863e-21
    #>  [16]  6.210122e-23  4.211760e-22  2.040715e-22  8.378627e-22 -1.024134e-21
    #>  [21] -2.933111e-02  3.988142e-22  3.182622e-22 -2.888860e-02  1.230442e-21
    #>  [26] -1.134619e-21  7.453419e-22 -3.824298e-22  7.527038e-03 -1.512522e-21
    #>  [31] -1.475916e-22  2.691605e-22  4.532510e-22  3.843671e-23  5.966853e-22
    #>  [36] -3.999866e-22  9.309426e-23  2.171233e-22  8.298501e-22  6.924547e-22
    #>  [41] -9.370779e-22  6.656819e-22  2.139741e-21  4.495330e-23  6.539372e-22
    #>  [46] -4.633300e-22 -2.808602e-22  1.263384e-21  6.172929e-22 -5.858227e-23
    #>  [51] -1.134061e-21 -1.235508e-21 -4.339863e-22 -7.602758e-22  5.901845e-22
    #>  [56] -4.765872e-22 -1.089734e-21  6.723465e-23  1.671644e-21  1.393717e-22
    #>  [61]  1.924924e-21 -4.789962e-22 -3.460494e-22  4.124618e-22 -4.432178e-22
    #>  [66]  9.796097e-22 -2.248604e-22 -1.586239e-21 -1.685454e-21 -3.250234e-02
    #>  [71]  1.162286e-21  1.680045e-02  5.799100e-22  3.464091e-22 -4.270107e-23
    #>  [76]  9.618305e-22 -5.611466e-22 -8.867522e-03  2.552310e-22  1.062613e-21
    #>  [81]  7.208103e-22  9.970952e-23 -1.138525e-03  6.899562e-22  5.825582e-02
    #>  [86]  8.258170e-22 -6.318444e-22 -2.065891e-23  2.939256e-22  5.516139e-22
    #>  [91]  8.346852e-03 -1.095036e-21  4.456472e-22 -1.604321e-21  5.076739e-22
    #>  [96] -9.588507e-22  1.173269e-21  3.990532e-03  1.012834e-21 -8.027366e-22
    #> [101] -9.071968e-22  3.579744e-22  4.535773e-22  4.048132e-22 -3.407500e-22
    #> [106] -6.561797e-22  4.956654e-22  7.287693e-22  3.749733e-22 -9.753295e-22
    #> [111]  1.157000e-21  3.318544e-02 -2.402727e-22  8.052994e-22 -6.860369e-23
    #> [116] -7.973557e-22 -3.865873e-22 -4.926104e-22 -3.965526e-22  1.193180e-21
    #> [121] -9.864090e-22  3.805366e-22  1.834437e-23  9.395870e-03 -7.079908e-22
    #> [126]  9.964020e-22  6.637081e-22  1.652883e-22  9.094413e-22  5.207640e-22
    #> [131]  6.676773e-22 -9.136353e-22  3.173172e-23 -7.838593e-22  2.543913e-22
    #> [136]  1.548749e-02 -2.071380e-22 -1.638857e-21  4.934784e-22  7.352201e-22
    #> [141]  5.993312e-22 -4.277900e-22 -7.060907e-22  2.919734e-22 -9.597208e-22
    #> [146]  7.985094e-22  8.811201e-22  1.367093e-21 -8.946659e-22  1.316468e-21
    #> [151] -7.130835e-22 -3.025974e-22  2.721522e-02 -1.161275e-22  2.935904e-22
    #> [156]  3.321183e-22  1.035261e-21 -1.262929e-21 -5.831626e-02 -4.548928e-22
    #> [161]  8.442647e-24 -8.095029e-22  7.406632e-22 -7.920716e-22  8.419305e-22
    #> [166]  1.821021e-22  9.796252e-22  2.556460e-22 -2.711714e-23 -7.253137e-23
    #> [171]  1.940057e-23 -6.939530e-22 -1.568173e-22 -1.764368e-23  2.272889e-22
    #> [176]  1.166228e-21  3.976971e-22  1.525921e-22  6.710661e-22 -7.849142e-23
    #> [181]  1.758187e-21 -1.251393e-21  5.123308e-22  1.022005e-21 -2.089899e-22
    #> [186] -4.894647e-22  5.414595e-22  4.870184e-22 -1.090100e-21 -6.975749e-22
    #> [191] -8.660354e-22 -1.122082e-21  9.213372e-23  5.137562e-22  3.150897e-22
    #> [196] -7.069428e-22 -5.321783e-22  4.689796e-22  2.036088e-22  4.827868e-22
    #> [201]  4.478207e-22 -9.142895e-22 -6.895911e-23  1.261476e-21 -1.743583e-21
    #> [206] -4.809400e-22 -8.341198e-22  1.289252e-21  6.707272e-22 -1.141036e-21
    #> [211]  1.545052e-02 -1.087027e-21  3.868099e-03  1.228452e-21 -4.993406e-22
    #> [216]  2.063223e-21 -2.141227e-21 -9.023999e-22 -5.457233e-22  6.350968e-22
    #> [221]  3.299787e-22  2.967582e-22 -3.296290e-22 -1.045672e-21 -6.355031e-23
    #> [226]  6.288033e-22  4.256010e-02 -4.444663e-22 -7.300713e-22  7.430271e-22
    #> [231]  8.578332e-23  1.902855e-02  9.122377e-22  6.960827e-22  4.699544e-22
    #> [236] -4.598985e-02  6.408401e-23 -1.474421e-21  1.729480e-22  9.208938e-22
    #> [241] -5.765653e-22  4.988325e-22  1.187370e-22 -1.599432e-21  3.997236e-23
    #> [246]  7.054493e-22 -4.940896e-22 -1.119343e-21  2.491516e-22 -1.477112e-22
    #> [251] -9.073350e-03  2.562475e-22 -1.340278e-21  4.577671e-03 -1.125082e-21
    #> [256] -5.492123e-22  1.221184e-22  6.604854e-22  8.193043e-22  1.678838e-21
    #> [261] -8.740783e-22 -7.996254e-22  1.242494e-21  7.548955e-22 -4.352809e-22
    #> [266]  4.659513e-22 -4.956230e-22 -8.887936e-22 -1.829678e-22 -1.220196e-03
    #> [271] -1.038457e-21 -5.988971e-22 -2.246577e-22 -1.165364e-21  3.939538e-23
    #> [276]  1.686867e-21 -5.883000e-22  4.643458e-22  1.788979e-22  1.397884e-21
    #> [281]  1.064198e-21  1.087226e-21  3.956553e-22  4.491465e-23  3.805867e-22
    #> [286]  1.531828e-22  6.551314e-22 -5.378804e-22  6.319462e-22 -1.279879e-02
    #> [291] -9.506124e-22 -3.700034e-22  7.261140e-22 -1.273780e-22 -1.758588e-21
    #> [296]  1.053523e-21 -1.356365e-21 -4.944358e-22 -1.295648e-21  8.134262e-22
    #> [301]  6.558863e-22 -1.235311e-21 -2.887367e-22  2.385786e-22  8.743031e-22
    #> [306] -5.945088e-22  3.373419e-22  1.596944e-22 -9.281430e-23  1.164168e-21
    #> [311]  5.965450e-22 -7.553042e-22  9.691943e-22  7.672510e-22  8.631675e-22
    #> [316]  1.613292e-21  2.176081e-21  2.449105e-22  1.793379e-21  2.634867e-22
    #> [321] -2.675636e-22  3.980448e-22 -6.119249e-23 -1.307458e-21  2.078788e-22
    #> [326] -1.885902e-22  1.297635e-22 -9.637561e-22  1.313468e-21 -8.033801e-22
    #> [331]  1.283161e-21  3.157173e-02  9.220821e-22  8.226218e-22 -1.410673e-22
    #> [336]  6.794923e-22  2.891027e-02  2.179215e-22 -7.535223e-22 -8.245117e-22
    #> [341]  9.525806e-22  1.659118e-22  5.030449e-22  5.128473e-22 -6.377654e-22
    #> [346] -1.425728e-21 -1.823244e-22  6.318094e-22  1.285789e-21  1.260664e-21
    #> [351] -7.737238e-22 -1.620745e-21  8.179635e-22 -5.814191e-22 -7.567276e-22
    #> [356] -1.081649e-22  4.714458e-22  1.778615e-22  1.442448e-21 -1.070562e-02
    #> [361]  9.432304e-22  4.650271e-02 -2.568660e-21 -5.207585e-22  1.383665e-21
    #> [366]  6.756196e-22  1.395793e-21  1.359266e-02 -2.116068e-22  6.611631e-22
    #> [371]  9.960319e-22  4.169444e-22 -7.213785e-22 -1.208596e-22 -2.396482e-21
    #> [376] -8.506236e-22 -8.888245e-22  2.514015e-02  1.779653e-22 -1.857789e-22
    #> [381]  3.416576e-24  1.112271e-22 -1.072091e-21  5.065115e-22  1.855061e-21
    #> [386]  1.123656e-21 -4.844171e-22  3.680011e-22  1.185630e-21 -1.186481e-21
    #> [391] -8.633372e-22  1.376082e-02  7.836479e-22  1.397796e-22 -6.531982e-22
    #> [396] -9.643130e-23 -1.492250e-02 -3.134367e-22  2.063791e-22  1.626651e-22

    ## Finding Projection Direction using best step size

    Direction.est <- FIHR::Direction_searchtuning(X,loading=c(1,rep(0,(p-1))))
    #> [1] 3
    Direction.est$proj
    #>   [1]  5.554458e-01 -2.649949e-22 -2.935041e-22 -9.308266e-22  4.438968e-22
    #>   [6] -2.627730e-02  3.593772e-22  1.903746e-22 -4.875036e-22  6.623102e-22
    #>  [11]  3.438229e-22 -2.131640e-22 -9.866852e-22  4.937538e-22  2.205145e-21
    #>  [16]  6.135539e-23  4.028539e-22  1.899994e-22  8.355370e-22 -9.887876e-22
    #>  [21] -2.933111e-02  3.800073e-22  3.248420e-22 -2.888860e-02  1.151004e-21
    #>  [26] -1.086868e-21  6.829906e-22 -3.302135e-22  7.527038e-03 -1.451804e-21
    #>  [31] -7.216231e-23  2.209585e-22  4.107058e-22  1.848644e-23  5.485342e-22
    #>  [36] -3.600470e-22  9.485655e-23  2.224761e-22  8.190905e-22  6.366885e-22
    #>  [41] -9.101344e-22  6.527847e-22  1.973794e-21  2.557024e-23  6.469378e-22
    #>  [46] -4.052502e-22 -3.042155e-22  1.187133e-21  6.255340e-22 -1.265652e-23
    #>  [51] -1.102697e-21 -1.167611e-21 -3.923160e-22 -7.202044e-22  5.876077e-22
    #>  [56] -4.660512e-22 -1.042773e-21  5.723796e-23  1.550586e-21  1.313265e-22
    #>  [61]  1.816522e-21 -4.655960e-22 -3.179358e-22  3.231203e-22 -4.381223e-22
    #>  [66]  9.431475e-22 -2.071671e-22 -1.527978e-21 -1.642355e-21 -3.250234e-02
    #>  [71]  1.092036e-21  1.680045e-02  5.140615e-22  2.857321e-22 -6.815981e-23
    #>  [76]  9.309394e-22 -5.528261e-22 -8.867522e-03  2.195600e-22  9.824650e-22
    #>  [81]  7.228835e-22  7.139939e-23 -1.138525e-03  6.810310e-22  5.825582e-02
    #>  [86]  7.463650e-22 -5.827235e-22 -1.880180e-23  2.750344e-22  4.670745e-22
    #>  [91]  8.346852e-03 -1.061591e-21  4.413142e-22 -1.532792e-21  5.061723e-22
    #>  [96] -9.397552e-22  1.155950e-21  3.990532e-03  9.561392e-22 -7.860021e-22
    #> [101] -8.808909e-22  3.343596e-22  4.166749e-22  3.827685e-22 -3.310282e-22
    #> [106] -6.322264e-22  4.803393e-22  6.996662e-22  3.637913e-22 -9.251082e-22
    #> [111]  1.143862e-21  3.318544e-02 -2.309992e-22  7.802599e-22 -6.652233e-23
    #> [116] -7.823282e-22 -3.862633e-22 -4.801002e-22 -3.634581e-22  1.121505e-21
    #> [121] -9.301893e-22  3.194216e-22  3.679936e-23  9.395870e-03 -6.711542e-22
    #> [126]  9.351731e-22  6.815533e-22  1.710306e-22  8.721257e-22  5.080886e-22
    #> [131]  6.150193e-22 -8.767920e-22  7.735924e-23 -7.530912e-22  2.817712e-22
    #> [136]  1.548749e-02 -1.500308e-22 -1.590672e-21  4.648118e-22  6.682853e-22
    #> [141]  5.977761e-22 -4.024925e-22 -6.393799e-22  2.681049e-22 -8.877174e-22
    #> [146]  7.643297e-22  8.353789e-22  1.305664e-21 -8.490776e-22  1.267885e-21
    #> [151] -7.031192e-22 -2.824359e-22  2.721522e-02 -1.046255e-22  3.033732e-22
    #> [156]  3.322714e-22  9.914141e-22 -1.215008e-21 -5.831626e-02 -4.185118e-22
    #> [161]  4.608284e-24 -7.615827e-22  6.721277e-22 -7.320983e-22  7.655132e-22
    #> [166]  1.613051e-22  9.425604e-22  2.628306e-22 -6.422104e-25 -7.523530e-23
    #> [171] -1.284897e-23 -6.540174e-22 -1.714473e-22 -3.023241e-23  2.178541e-22
    #> [176]  1.145137e-21  3.942510e-22  6.099592e-23  6.426503e-22 -1.174537e-22
    #> [181]  1.702316e-21 -1.157128e-21  4.791944e-22  9.862406e-22 -1.952091e-22
    #> [186] -4.708978e-22  5.122212e-22  4.393046e-22 -1.019818e-21 -6.367657e-22
    #> [191] -8.497266e-22 -1.065425e-21  8.420451e-23  4.673521e-22  2.742540e-22
    #> [196] -6.411862e-22 -5.087647e-22  4.459346e-22  1.960081e-22  4.521727e-22
    #> [201]  4.646695e-22 -8.938033e-22 -7.538133e-23  1.219838e-21 -1.673025e-21
    #> [206] -4.583889e-22 -7.853585e-22  1.202555e-21  6.417642e-22 -1.087652e-21
    #> [211]  1.545052e-02 -1.039853e-21  3.868099e-03  1.179486e-21 -4.494145e-22
    #> [216]  1.967594e-21 -2.042256e-21 -8.072359e-22 -5.154276e-22  5.800101e-22
    #> [221]  3.153061e-22  2.727401e-22 -3.069789e-22 -9.693535e-22 -5.080124e-23
    #> [226]  5.745263e-22  4.256010e-02 -4.649953e-22 -6.790343e-22  7.447630e-22
    #> [231]  8.909173e-23  1.902855e-02  8.393424e-22  6.794904e-22  4.634554e-22
    #> [236] -4.598985e-02  6.493736e-23 -1.421003e-21  2.063204e-22  8.898912e-22
    #> [241] -5.463784e-22  4.848465e-22  1.134767e-22 -1.530273e-21  5.325400e-23
    #> [246]  6.989138e-22 -4.781917e-22 -1.072662e-21  2.910892e-22 -1.115937e-22
    #> [251] -9.073350e-03  2.321442e-22 -1.276438e-21  4.577671e-03 -1.072948e-21
    #> [256] -5.028936e-22  9.188270e-23  6.474792e-22  7.545070e-22  1.642505e-21
    #> [261] -8.037580e-22 -7.537026e-22  1.102785e-21  7.205506e-22 -4.044722e-22
    #> [266]  4.504322e-22 -4.890696e-22 -8.261679e-22 -1.713330e-22 -1.220196e-03
    #> [271] -9.915416e-22 -5.651138e-22 -2.060122e-22 -1.116860e-21  5.359101e-25
    #> [276]  1.588214e-21 -5.590976e-22  4.375756e-22  2.113168e-22  1.332886e-21
    #> [281]  1.030355e-21  1.057661e-21  4.008938e-22  4.562377e-23  3.565907e-22
    #> [286]  1.617697e-22  6.106819e-22 -4.926359e-22  6.172201e-22 -1.279879e-02
    #> [291] -9.344045e-22 -3.588062e-22  6.876569e-22 -1.118113e-22 -1.641141e-21
    #> [296]  1.027382e-21 -1.287225e-21 -4.713213e-22 -1.224590e-21  7.837724e-22
    #> [301]  6.334670e-22 -1.138217e-21 -2.381326e-22  2.180116e-22  8.377082e-22
    #> [306] -5.870868e-22  3.512199e-22  1.368412e-22 -7.282924e-23  1.151625e-21
    #> [311]  5.525220e-22 -7.128246e-22  9.092912e-22  7.443853e-22  8.058590e-22
    #> [316]  1.548681e-21  2.071389e-21  2.438391e-22  1.703225e-21  2.514450e-22
    #> [321] -2.264812e-22  3.837238e-22 -3.451995e-23 -1.240885e-21  2.271267e-22
    #> [326] -1.595232e-22  8.921269e-23 -9.248654e-22  1.262769e-21 -7.598625e-22
    #> [331]  1.214038e-21  3.157173e-02  8.758905e-22  7.436291e-22 -1.218495e-22
    #> [336]  6.727616e-22  2.891027e-02  2.297365e-22 -7.035386e-22 -7.928667e-22
    #> [341]  9.017677e-22  1.566826e-22  4.679120e-22  4.748005e-22 -6.442862e-22
    #> [346] -1.343702e-21 -2.118113e-22  6.130756e-22  1.188511e-21  1.204840e-21
    #> [351] -7.475189e-22 -1.519254e-21  7.848338e-22 -5.541763e-22 -7.773805e-22
    #> [356] -1.178239e-22  4.209490e-22  1.278655e-22  1.326692e-21 -1.070562e-02
    #> [361]  9.032645e-22  4.650271e-02 -2.423813e-21 -5.275982e-22  1.356756e-21
    #> [366]  6.567257e-22  1.301542e-21  1.359266e-02 -1.814582e-22  6.366164e-22
    #> [371]  9.631283e-22  3.993846e-22 -7.058868e-22 -1.325687e-22 -2.312453e-21
    #> [376] -7.996282e-22 -8.296459e-22  2.514015e-02  2.095906e-22 -1.504103e-22
    #> [381]  6.698928e-23  1.349254e-22 -1.027137e-21  4.689831e-22  1.742072e-21
    #> [386]  1.105312e-21 -4.515815e-22  3.207763e-22  1.130388e-21 -1.096585e-21
    #> [391] -8.454193e-22  1.376082e-02  7.284880e-22  1.578045e-22 -6.535111e-22
    #> [396] -1.106388e-22 -1.492250e-02 -2.808910e-22  2.062135e-22  1.799429e-22

Finding Projection Direction in Logistic Regression


    n = 50
    p = 400
    X = matrix(sample(-2:2,n*p,replace = TRUE),nrow=n,ncol=p)
    y = rbinom(n,1,0.5)
    col.norm <- 1/sqrt((1/n)*diag(t(X)%*%X)+0.0001);
    Xnor <- X %*% diag(col.norm);
    fit = glmnet::cv.glmnet(Xnor, y, alpha=1,family = "binomial")
    htheta <- as.vector(coef(fit, s = "lambda.min"))
    support<-(abs(htheta)>0.001)
    Xb <- cbind(rep(1,n),Xnor);
    Xc <- cbind(rep(1,n),X);
    col.norm <- c(1,col.norm);
    pp <- (p+1);
    xnew = c(1,rep(0,(p-1)))
    loading=rep(0,pp)
    loading[1]=1
    loading[-1]=xnew
    htheta <- htheta*col.norm;
    htheta <- as.vector(htheta)
    f_prime <- exp(Xc%*%htheta)/(1+exp(Xc%*%htheta))^2

    ## Finding Projection Direction using fixed tuning parameter

    Direction.est <- FIHR::Direction_fixedtuning(X,loading=c(1,rep(0,(p-1))),mu=sqrt(2.01*log(p)/n)*resol^{-(step-1)},model = "logistic",weight = 1/f_prime, deriv.vec = f_prime)
    #> [1] "fixed mu"
    #> [1] 0.2181208
    Direction.est$proj
    #> numeric(0)

    ## Finding Projection Direction using best step size

    Direction.est <- FIHR::Direction_searchtuning(Xc,loading,model = "logistic",weight = 1/f_prime, deriv.vec = f_prime)
    #> [1] 2
    Direction.est$proj
    #>   [1]  4.487479e-01  3.445240e-01  2.997872e-06 -1.704572e-06 -1.249521e-05
    #>   [6]  2.835407e-06  3.515299e-06 -1.081646e-06 -2.275051e-06 -1.090921e-06
    #>  [11]  3.840716e-06  1.247003e-05  7.910256e-06  5.248394e-07 -7.438542e-07
    #>  [16] -4.348441e-06 -1.301035e-06  4.242276e-06  3.315505e-06  1.227688e-05
    #>  [21]  4.231219e-06  5.990429e-07  8.859675e-07  1.886395e-06  6.144516e-06
    #>  [26] -2.913640e-06 -7.242925e-07 -2.885784e-06 -1.094815e-06 -5.294639e-06
    #>  [31]  1.440184e-07  6.987363e-06  8.329008e-06 -2.587624e-06 -2.525768e-06
    #>  [36] -6.605271e-06  2.099341e-06  4.798103e-06 -1.147825e-05  3.982914e-06
    #>  [41]  1.351915e-06 -3.026097e-06  1.608986e-06  1.403180e-08  5.571198e-06
    #>  [46] -2.836818e-06  4.123587e-06 -4.048661e-06 -3.524106e-06 -1.366234e-06
    #>  [51] -4.273735e-06 -1.577969e-06 -8.068748e-06 -9.291899e-06  4.418228e-06
    #>  [56] -6.358723e-06  2.936807e-06  3.834373e-06  2.569815e-07 -7.825247e-06
    #>  [61]  5.900277e-06  4.584407e-06  7.301589e-06  1.325027e-06 -1.197950e-05
    #>  [66]  3.092174e-09 -7.633142e-06 -3.334989e-06  1.257234e-06 -4.646596e-06
    #>  [71] -6.543654e-06  1.200699e-06 -5.633248e-06 -2.941124e-06  4.120231e-06
    #>  [76] -4.620295e-06 -4.888521e-06  4.548308e-06 -3.776095e-06  7.083594e-06
    #>  [81] -1.845570e-06 -1.496879e-07  1.341349e-05  3.691237e-07 -7.472240e-06
    #>  [86] -6.396152e-07 -3.975297e-06 -1.401101e-06 -7.772364e-07  2.724474e-07
    #>  [91]  2.079404e-06  2.091831e-06 -3.542443e-06 -3.183340e-06 -5.652585e-06
    #>  [96] -3.051196e-06 -6.349891e-06  2.930117e-06 -6.487603e-06  6.709538e-07
    #> [101] -3.294428e-06 -2.661472e-06  7.351267e-06 -4.303425e-06 -1.393773e-06
    #> [106] -5.904513e-06 -3.795797e-06 -6.056137e-06  8.040956e-06  6.650055e-06
    #> [111]  4.225556e-06  2.269138e-06  5.729170e-06 -1.719990e-06 -1.292637e-06
    #> [116]  9.015489e-06 -1.138514e-06 -6.630716e-07  4.545640e-06 -1.023688e-06
    #> [121] -1.060843e-05 -3.533632e-06 -4.729860e-06 -2.001536e-06 -4.880045e-06
    #> [126]  7.755132e-06  1.014056e-06 -5.747949e-06  5.275278e-06  1.451502e-06
    #> [131] -4.500244e-06 -2.916522e-06  3.563355e-06  1.771619e-06 -3.589700e-07
    #> [136] -5.968224e-06 -9.299556e-06 -5.066764e-06 -3.308117e-06 -3.433192e-06
    #> [141]  9.434693e-06  7.180580e-06  6.159670e-06 -5.326723e-07 -2.162435e-06
    #> [146]  1.157919e-05  8.390508e-07  4.943841e-06 -4.555002e-06  6.365292e-06
    #> [151]  1.177233e-06  9.984053e-06  5.638460e-06  4.606180e-06  1.652581e-06
    #> [156]  7.978470e-06 -6.698798e-06 -2.718372e-06  5.768270e-06 -9.584390e-06
    #> [161]  7.376494e-06  7.145366e-06 -2.466821e-06 -7.988330e-06 -4.758323e-06
    #> [166]  1.509123e-06 -5.420847e-06  9.472336e-06 -9.528501e-06 -5.297757e-06
    #> [171] -6.435140e-06  5.618688e-06 -5.980869e-06  6.873674e-06 -8.475512e-07
    #> [176] -7.473731e-06 -1.863269e-06 -3.655344e-06  1.313100e-06 -6.984687e-06
    #> [181]  3.618440e-06  1.924122e-06 -5.503685e-06 -2.452464e-06  7.322968e-07
    #> [186]  4.489188e-06 -4.180944e-06 -3.110487e-07  4.984611e-06  7.916846e-06
    #> [191]  6.273557e-06 -8.037064e-06 -1.130224e-06 -4.719260e-06  2.393500e-06
    #> [196]  1.589037e-07 -3.997430e-06  5.747547e-06 -2.174004e-06  3.800633e-06
    #> [201] -3.498611e-06  1.723168e-06 -3.542431e-06  1.665863e-06 -5.463718e-06
    #> [206]  1.663909e-06  4.270557e-06 -7.106322e-06 -5.298587e-07 -2.838948e-06
    #> [211]  3.475170e-06  7.433675e-06 -2.971172e-06 -4.892906e-06 -7.122183e-06
    #> [216]  9.000093e-06  1.180519e-05 -4.704973e-06 -1.623037e-06 -7.143667e-07
    #> [221] -4.559388e-06 -9.884497e-07 -2.845328e-06  3.271864e-06  7.529209e-06
    #> [226] -7.518469e-06  4.473373e-06 -6.574617e-06  2.990408e-06 -3.299431e-06
    #> [231]  8.486626e-06  2.257366e-06 -4.798743e-06  3.448637e-06  5.697260e-06
    #> [236]  5.827989e-06  3.705106e-06  3.244730e-06 -4.935054e-06  4.834034e-06
    #> [241]  7.333407e-06  1.289826e-05 -7.631790e-06  1.562280e-06  1.170669e-05
    #> [246] -1.043708e-05 -2.137652e-06 -1.388024e-06 -5.780599e-06 -3.235210e-06
    #> [251]  6.358904e-07 -4.475150e-06 -8.309081e-06 -1.368640e-05  9.865075e-06
    #> [256] -1.627080e-06 -4.990163e-06  2.675561e-06  4.128981e-06  6.495210e-06
    #> [261]  8.664570e-06  9.369921e-06  4.858602e-06 -1.988118e-07  2.613668e-07
    #> [266] -2.673510e-06  7.839675e-06 -7.975582e-06 -1.151292e-06  1.272794e-06
    #> [271] -5.504792e-06  1.295909e-07 -7.615508e-06  5.952791e-06 -4.302057e-06
    #> [276]  6.201924e-06  6.099290e-06  6.733604e-07 -2.803720e-06 -6.332053e-06
    #> [281]  3.788366e-06  7.028205e-06  5.817552e-06  1.029578e-05 -1.539928e-06
    #> [286] -3.228372e-07 -8.771872e-06 -3.905585e-06  3.716989e-06 -3.654796e-06
    #> [291]  3.888649e-06  8.044446e-06  7.222093e-07  7.567696e-07  3.619046e-06
    #> [296] -9.433394e-06 -6.534995e-07 -3.945623e-06  2.176506e-06 -2.055444e-07
    #> [301] -2.757808e-06 -1.790165e-06  4.635123e-06 -7.731800e-06  3.243949e-06
    #> [306] -6.054224e-07 -8.729043e-06  8.032634e-06  1.365440e-06 -1.802208e-06
    #> [311] -9.567865e-06 -2.144011e-06  4.931007e-06 -3.982039e-07 -3.333401e-06
    #> [316]  5.347709e-06 -1.306433e-06 -1.566785e-06  3.931749e-06 -9.725441e-06
    #> [321]  6.006567e-06 -4.293515e-07 -2.880526e-07 -3.407044e-06  9.565223e-06
    #> [326]  1.128494e-06 -4.630360e-06 -5.456705e-06 -2.068159e-06  1.344945e-06
    #> [331]  1.797623e-06  4.445831e-06 -8.462347e-06  6.948860e-06  2.266208e-07
    #> [336]  4.798680e-06  3.474883e-08  2.501984e-07 -2.788656e-06  1.568538e-06
    #> [341]  5.235925e-06 -6.177738e-07  1.509799e-06  4.508450e-06  4.048787e-06
    #> [346]  3.556344e-06 -4.816683e-06  3.169178e-06  2.487107e-07 -4.224501e-06
    #> [351] -4.922645e-06 -5.262417e-07  8.096640e-06 -2.558189e-06 -1.889581e-06
    #> [356]  5.528358e-06  2.318908e-06 -4.612071e-06 -2.527201e-07  3.342468e-06
    #> [361] -1.804169e-06  1.209645e-05  1.116226e-05  1.196313e-06  4.314297e-06
    #> [366] -2.798033e-06 -9.349315e-07  4.512359e-06 -2.356944e-07  5.335851e-06
    #> [371]  6.674176e-06 -9.260472e-06  2.022451e-06 -5.860284e-06  7.262904e-06
    #> [376] -3.339598e-06 -5.717377e-06  7.427194e-06  4.924991e-06 -2.010641e-06
    #> [381] -6.946200e-08  1.582879e-06 -2.247125e-06  4.602919e-06  2.471054e-06
    #> [386] -4.431494e-06 -2.521785e-06  1.873760e-06 -2.579517e-06 -4.520894e-06
    #> [391]  1.114858e-05 -1.975227e-06 -5.719136e-06  5.376039e-06  2.520607e-06
    #> [396] -5.603688e-06  5.245482e-06 -5.527908e-06  8.453629e-07  4.875962e-07
    #> [401] -3.812651e-06
