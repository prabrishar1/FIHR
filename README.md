
<!-- README.md is generated from README.Rmd. Please edit that file -->

FIHR
====

<!-- badges: start -->
<!-- badges: end -->

The goal of FIHR is to provide inference for linear and quadratic
functionals in high-dimensional linear and logistic regression models.
It computes bias-corrected estimators and corresponding standard errors
for the linear and quadratic functionals.

Installation
------------

You can install the development version from
[GitHub](https://github.com/) with:

    # install.packages("devtools")
    devtools::install_github("prabrishar1/FIHR")

Example
-------

These are basic examples which show how to solve the common
high-dimensional inference problems:

    library(FIHR)

Inference for linear functional in high-dimensional linear regression
model


    library(MASS)
    n = 100
    p = 400
    A1gen <- function(rho,p){
      A1=matrix(0,p,p)
      for(i in 1:p){
        for(j in 1:p){
          A1[i,j]<-rho^(abs(i-j))
        } 
      }
      A1
    }
    mu <- rep(0,p)
    mu[1:5] <- c(1:5)/5
    rho = 0.5
    Cov <- (A1gen(rho,p))/2
    Cov2<-matrix(NA,nrow=p,ncol=p)
    for(i in 1:p){
        for(j in 1:p){
        Cov2[i,j]<-0.5^(1+abs(i-j))
        } 
      }
    beta <- rep(0,p)
    beta[1:10] <- c(1:10)/5
    X <- MASS::mvrnorm(n,mu,Cov)
    y = X%*%beta + rnorm(n)
    loading <- MASS::mvrnorm(1,rep(0,p),Cov2)
    Est = FIHR::LF(X = X, y = y, loading = loading, intercept = TRUE)
    #> [1] 3
    #> [1] 3
    #> [1] 3
    #> [1] "step is 3"
    #> [1] "fixed mu"
    #> [1] 0.1542668
    Est$prop.est
    #>           [,1]
    #> [1,] -7.172361
    Est$se
    #> [1] 1.906665

Inference for linear functional in high-dimensional logistic regression
model

    library(MASS)
    A1gen <- function(rho,p){
      A1=matrix(0,p,p)
      for(i in 1:p){
        for(j in 1:p){
          A1[i,j]<-rho^(abs(i-j))
        } 
      }
      A1
    }
    n = 100
    p = 400
    mu <- rep(0,p)
    rho = 0.5
    Cov <- (A1gen(rho,p))/2
    Cov2<-matrix(NA,nrow=p,ncol=p)
    for(i in 1:p){
        for(j in 1:p){
        Cov2[i,j]<-0.5^(1+abs(i-j))
        } 
      }
    beta <- rep(0,p)
    beta[1:10] <- c(1:10)/5
    X <- MASS::mvrnorm(n,mu,Cov)
    exp_val <- X%*%beta
    prob <- exp(exp_val)/(1+exp(exp_val))
    y <- rbinom(n,1,prob)
    loading <- MASS::mvrnorm(1,mu,Cov2)
    Est = FIHR::LF_logistic(X = X, y = y, loading = loading, intercept = TRUE, weight = rep(1,n))
    #> [1] 3
    #> [1] 3
    #> [1] 4
    #> [1] "step is 3"
    #> [1] "fixed mu"
    #> [1] 0.1542668
    Est$prop.est
    #> [1] 3.042965
    Est$se
    #> [1] 2.721417

Inference for quadratic functional in high-dimensional linear model


    library(MASS)
    A1gen <- function(rho,p){
      A1=matrix(0,p,p)
      for(i in 1:p){
        for(j in 1:p){
          A1[i,j]<-rho^(abs(i-j))
        } 
      }
      A1
    }
    rho = 0.6
    Cov <- (A1gen(rho,400))
    mu <- rep(0,400)
    mu[1:5] <- c(1:5)/5
    beta <- rep(0,400)
    beta[25:50] <- 0.08
    X <- MASS::mvrnorm(100,mu,Cov)
    y <- X%*%beta + rnorm(100)
    test.set <- c(30:100)

    ## Inference for Quadratic Functional with Population Covariance Matrix in middle

    Est = FIHR::QF(X = X, y = y, G=test.set)
    #> [1] 5
    #> [1] 5
    #> [1] 5
    #> [1] "fixed mu"
    #> [1] 0.1421723
    #> [1] "step is 5"
    Est$prop.est
    #>           [,1]
    #> [1,] 0.5683856
    Est$se
    #> [1] 0.1292716

    ## Inference for Quadratic Functional with known matrix A in middle

    Est = FIHR::QF(X = X, y = y, G=test.set, Cov.weight = FALSE,A = diag(1:400,400))
    #> [1] 5
    #> [1] 5
    #> [1] 5
    #> [1] "fixed mu"
    #> [1] 0.1421723
    #> [1] "step is 5"
    Est$prop.est
    #>          [,1]
    #> [1,] 12.28869
    Est$se
    #> [1] 2.323133

    ## Inference for square norm of regression vector

    Est = FIHR::QF(X = X, y = y, G=test.set, Cov.weight = FALSE,A = diag(1,400))
    #> [1] 5
    #> [1] 5
    #> [1] 5
    #> [1] "fixed mu"
    #> [1] 0.1421723
    #> [1] "step is 5"
    Est$prop.est
    #>           [,1]
    #> [1,] 0.3219615
    Est$se
    #> [1] 0.08636724

Finding projection direction in high dimensional linear regression


    n = 100
    p = 400
    X = matrix(sample(-2:2,n*p,replace = TRUE),nrow = n,ncol = p)
    resol = 1.5
    step = 3

    ## Finding Projection Direction using fixed tuning parameter

    Direction.est <- FIHR::Direction_fixedtuning(X,loading=c(1,rep(0,(p-1))),mu=sqrt(2.01*log(p)/n)*resol^{-(step-1)})
    #> [1] "fixed mu"
    #> [1] 0.1542347
    Direction.est$proj
    #>   [1]  7.486134e-01  3.925117e-02 -3.847578e-21 -2.022864e-21  3.461574e-22
    #>   [6]  2.968984e-21  2.590287e-21 -5.565964e-22  9.520373e-22 -5.851984e-22
    #>  [11] -1.580267e-21 -4.835087e-21  6.048091e-22 -2.096171e-21  4.128615e-21
    #>  [16]  3.443999e-22  9.866725e-03  1.715089e-21 -1.067520e-02 -4.797981e-22
    #>  [21] -4.130999e-21  3.644533e-21  4.185742e-22  2.819774e-21  1.584541e-21
    #>  [26] -3.004514e-21  3.462883e-21  2.626413e-21  5.454384e-22  9.263014e-22
    #>  [31]  1.829311e-21 -1.185003e-21 -6.838934e-23  2.554247e-21 -3.380281e-02
    #>  [36] -7.110414e-22 -1.215772e-21  1.268352e-22 -1.007180e-03  1.834435e-21
    #>  [41] -3.479824e-21  1.964153e-02 -1.236906e-22  4.095350e-22  1.109082e-21
    #>  [46]  2.235452e-21  1.456341e-21  1.227438e-21  8.136410e-22 -1.119616e-21
    #>  [51] -3.442608e-21 -2.611868e-03 -1.293545e-21  3.797591e-21  2.362193e-02
    #>  [56] -3.091304e-22  2.982714e-21  4.747241e-21  1.102987e-21  2.473472e-21
    #>  [61] -2.078205e-21 -1.453995e-21  2.447592e-21  2.117033e-21  3.326646e-21
    #>  [66]  1.412052e-21 -3.268396e-21  2.304404e-21 -2.563683e-22 -1.241570e-21
    #>  [71] -4.529864e-21 -2.554741e-22 -1.050224e-21 -4.129224e-21  2.148726e-21
    #>  [76] -3.464114e-21 -6.268788e-04  1.451562e-21  8.760968e-22  7.983481e-22
    #>  [81]  1.939087e-21 -7.562969e-22  4.471315e-23 -4.091497e-21 -6.235621e-02
    #>  [86]  9.544259e-22  1.557048e-21 -8.415117e-22 -2.065446e-21  4.497124e-22
    #>  [91] -3.249377e-21  2.388692e-21 -9.736934e-22  3.967642e-22 -4.095471e-21
    #>  [96]  5.891964e-21  1.887564e-21 -1.927692e-22 -2.168478e-21 -4.479279e-21
    #> [101] -4.947039e-02  1.297051e-21  4.115149e-22  7.238706e-22 -2.590538e-02
    #> [106] -7.606027e-23  1.084390e-22 -1.102805e-21  5.305475e-21 -1.273521e-21
    #> [111]  5.149304e-22 -1.869684e-21  4.608241e-22 -2.390130e-21  6.546180e-22
    #> [116]  1.694455e-22 -8.612880e-22 -2.243697e-23  5.366046e-24 -6.340153e-22
    #> [121] -5.236141e-21 -2.542904e-03  1.217418e-21  2.435875e-21 -4.781819e-21
    #> [126] -7.224092e-02  1.936337e-21 -9.313563e-22  3.787827e-21  1.606884e-21
    #> [131] -1.319922e-21 -3.140151e-21 -8.332759e-22  1.916521e-22  8.223558e-22
    #> [136] -1.374847e-21  4.625581e-22 -2.314979e-21 -2.000572e-21  1.662651e-02
    #> [141]  1.634413e-01  1.234555e-21 -2.113657e-21 -8.750545e-22  8.075288e-22
    #> [146] -8.836671e-22 -2.389297e-21  9.488815e-03  4.110457e-22 -5.054586e-22
    #> [151] -5.316544e-22  2.357577e-21  2.373383e-21  4.348266e-21  1.817672e-21
    #> [156] -2.782308e-21  3.177034e-21 -4.745208e-21  1.706880e-21  1.031689e-21
    #> [161]  9.044189e-22  1.338628e-21 -1.805590e-21  1.302109e-22 -1.962646e-21
    #> [166] -4.829229e-21  1.588545e-21  2.836802e-21  4.926831e-22 -1.075729e-01
    #> [171]  2.546589e-21 -7.478779e-22 -1.966543e-21 -3.031221e-22  6.115252e-21
    #> [176]  3.721702e-21  9.135338e-03  3.274742e-02  1.244936e-21  3.316860e-21
    #> [181]  2.481109e-21  3.198931e-21  1.294833e-21  7.145486e-22  9.124498e-22
    #> [186]  1.496670e-21 -2.052562e-21  2.043538e-21 -3.105742e-21  1.494317e-22
    #> [191]  2.050822e-21 -2.364455e-21  6.963800e-22 -1.532817e-21 -2.195477e-22
    #> [196] -3.337922e-21 -3.183965e-21  2.183507e-21 -4.179542e-22  3.703300e-21
    #> [201]  1.625777e-01 -4.589109e-21  3.868872e-22  4.445685e-21 -9.411719e-02
    #> [206]  5.156843e-21  3.927406e-23  6.904560e-22 -5.705839e-21 -4.192217e-21
    #> [211] -1.470265e-21 -1.392680e-21 -3.681514e-21 -9.270621e-22  4.558941e-21
    #> [216]  2.091319e-21  1.682280e-21  2.397093e-21 -1.868969e-21 -1.213134e-22
    #> [221]  1.926912e-22  2.569610e-21  3.557686e-23  1.533505e-21  1.478535e-21
    #> [226] -2.049732e-21 -3.574314e-22 -4.025839e-21 -1.093949e-21 -5.935424e-03
    #> [231] -2.723885e-21  4.961128e-22 -1.737698e-21 -8.495084e-23  3.037866e-21
    #> [236] -2.467720e-21 -9.783095e-22 -2.865972e-21 -1.628971e-21 -7.155935e-22
    #> [241] -1.257659e-21 -4.271340e-21 -4.964562e-21 -1.282160e-21 -3.146758e-21
    #> [246] -3.173678e-21 -3.128435e-21  3.534228e-21  6.298417e-23  1.429983e-21
    #> [251]  1.794794e-21 -8.569389e-22 -7.483996e-22  4.372538e-21  1.090677e-22
    #> [256] -2.967962e-21 -3.464349e-21  1.234410e-02  3.029786e-21  1.154316e-21
    #> [261]  9.866839e-22  1.144699e-21 -2.531926e-03 -2.048911e-21 -7.083896e-22
    #> [266]  1.261169e-21 -5.029050e-02 -2.064348e-21 -2.709585e-21 -3.141882e-21
    #> [271] -4.684887e-21 -5.481699e-21 -3.551956e-22 -2.942194e-22 -9.578095e-22
    #> [276]  3.494319e-22 -2.376044e-21  4.686752e-03 -3.288525e-21 -3.047640e-22
    #> [281]  1.213029e-21 -8.036073e-22 -7.334840e-22 -1.527814e-21 -5.380806e-21
    #> [286] -8.405020e-22  2.843562e-22 -6.529024e-22  2.165992e-22 -5.588097e-23
    #> [291]  7.884328e-22  2.600242e-21  1.662885e-21  4.393195e-22  2.248026e-21
    #> [296] -5.269542e-22  1.753303e-21 -2.198856e-21  2.120658e-21  9.326944e-22
    #> [301] -1.102990e-21  4.324364e-22  1.553938e-21  6.184900e-23  1.115331e-02
    #> [306]  2.802775e-21  2.110396e-21  1.492554e-21 -1.266388e-21  1.388126e-21
    #> [311] -5.161733e-22  5.889286e-21  1.606393e-21  4.135972e-22 -5.237478e-21
    #> [316]  3.777911e-21 -3.459435e-02 -4.829909e-22 -2.250866e-23  4.028028e-22
    #> [321] -2.545766e-21 -2.919373e-21  3.989339e-22  5.468904e-23  4.786818e-21
    #> [326] -1.103102e-02 -1.783265e-21 -1.833139e-21  9.589241e-22  8.457844e-23
    #> [331]  1.757176e-21 -3.498857e-21  3.521629e-21  1.688117e-21  3.100517e-22
    #> [336]  3.981764e-21  4.920794e-22 -1.563779e-01 -3.613522e-21  9.791645e-02
    #> [341]  1.122150e-23  3.338205e-21  3.516077e-21  1.075573e-22 -2.830094e-21
    #> [346]  2.237428e-21  5.957138e-03 -9.981021e-22 -9.070902e-03 -1.781253e-02
    #> [351] -7.576268e-23 -1.402809e-21  1.226497e-22  4.146251e-21 -3.988984e-21
    #> [356]  5.623037e-21 -3.705149e-21  1.659973e-21  3.195079e-21 -1.391181e-21
    #> [361] -3.391989e-21 -3.147855e-21 -5.828757e-22 -4.964656e-22 -6.918553e-22
    #> [366] -4.149790e-22 -2.811334e-02 -1.203731e-21  3.555786e-22 -1.884625e-21
    #> [371] -2.011043e-21 -1.649632e-21 -1.813032e-21 -2.990293e-22 -2.825522e-21
    #> [376]  4.946282e-21  1.901714e-21 -5.375079e-21 -1.714587e-21 -1.513662e-21
    #> [381]  6.473443e-22 -1.329025e-02 -1.486557e-21 -1.767977e-21  1.901533e-21
    #> [386]  1.516958e-21  2.528296e-21 -4.206128e-22 -5.215962e-21 -3.944269e-21
    #> [391] -3.212410e-21 -6.706657e-22  2.610978e-21 -2.243654e-22 -3.599675e-21
    #> [396]  2.734005e-21  3.563895e-22  7.054796e-22 -4.049930e-21  2.046444e-21

    ## Finding Projection Direction using best step size

    Direction.est <- FIHR::Direction_searchtuning(X,loading=c(1,rep(0,(p-1))))
    #> [1] 3
    Direction.est$proj
    #>   [1]  7.486134e-01  3.925117e-02 -3.805390e-21 -1.997848e-21  3.114190e-22
    #>   [6]  2.912705e-21  2.562299e-21 -5.540139e-22  9.880124e-22 -6.059602e-22
    #>  [11] -1.516667e-21 -4.798076e-21  5.692030e-22 -2.052914e-21  4.121301e-21
    #>  [16]  4.137186e-22  9.866725e-03  1.727603e-21 -1.067520e-02 -4.943826e-22
    #>  [21] -4.108474e-21  3.655494e-21  4.084963e-22  2.789510e-21  1.562987e-21
    #>  [26] -2.958675e-21  3.460495e-21  2.559371e-21  5.478209e-22  9.139477e-22
    #>  [31]  1.856938e-21 -1.164075e-21 -2.641521e-23  2.546634e-21 -3.380281e-02
    #>  [36] -7.125516e-22 -1.233052e-21  1.286567e-22 -1.007180e-03  1.815736e-21
    #>  [41] -3.466262e-21  1.964153e-02 -1.554708e-22  3.716190e-22  1.125831e-21
    #>  [46]  2.194829e-21  1.466647e-21  1.197061e-21  8.261036e-22 -1.109898e-21
    #>  [51] -3.431701e-21 -2.611868e-03 -1.294981e-21  3.760921e-21  2.362193e-02
    #>  [56] -2.905271e-22  3.006898e-21  4.709401e-21  1.061875e-21  2.439919e-21
    #>  [61] -2.083912e-21 -1.483738e-21  2.444535e-21  2.122197e-21  3.269777e-21
    #>  [66]  1.375897e-21 -3.268059e-21  2.276645e-21 -2.499132e-22 -1.206940e-21
    #>  [71] -4.451940e-21 -2.509663e-22 -1.044999e-21 -4.115629e-21  2.137168e-21
    #>  [76] -3.467440e-21 -6.268788e-04  1.436627e-21  8.663059e-22  7.962854e-22
    #>  [81]  1.939545e-21 -7.504985e-22  4.091445e-23 -4.028332e-21 -6.235621e-02
    #>  [86]  9.387312e-22  1.559504e-21 -8.660777e-22 -2.000053e-21  5.135857e-22
    #>  [91] -3.217916e-21  2.362542e-21 -1.029471e-21  3.748094e-22 -4.060587e-21
    #>  [96]  5.863532e-21  1.868081e-21 -2.123855e-22 -2.164573e-21 -4.454682e-21
    #> [101] -4.947039e-02  1.329246e-21  3.995471e-22  7.117570e-22 -2.590538e-02
    #> [106] -6.367446e-23  7.680103e-23 -1.122420e-21  5.259632e-21 -1.249083e-21
    #> [111]  4.877873e-22 -1.893669e-21  4.844975e-22 -2.346308e-21  6.802030e-22
    #> [116]  1.927665e-22 -8.495349e-22 -2.703559e-23  3.738289e-23 -6.319086e-22
    #> [121] -5.186983e-21 -2.542904e-03  1.218973e-21  2.375792e-21 -4.725400e-21
    #> [126] -7.224092e-02  1.912441e-21 -8.909601e-22  3.729159e-21  1.603553e-21
    #> [131] -1.288855e-21 -3.133494e-21 -8.091922e-22  2.083294e-22  8.543870e-22
    #> [136] -1.361596e-21  4.625754e-22 -2.305412e-21 -1.967698e-21  1.662651e-02
    #> [141]  1.634413e-01  1.210490e-21 -2.073458e-21 -8.710741e-22  8.058538e-22
    #> [146] -8.904017e-22 -2.398825e-21  9.488815e-03  3.757965e-22 -4.412162e-22
    #> [151] -5.629059e-22  2.358819e-21  2.385615e-21  4.286394e-21  1.790005e-21
    #> [156] -2.804179e-21  3.169964e-21 -4.672706e-21  1.700603e-21  1.029883e-21
    #> [161]  9.294293e-22  1.352801e-21 -1.816153e-21  1.099882e-22 -1.946704e-21
    #> [166] -4.825304e-21  1.582961e-21  2.835718e-21  4.728285e-22 -1.075729e-01
    #> [171]  2.529008e-21 -7.501846e-22 -1.921967e-21 -2.776473e-22  6.061963e-21
    #> [176]  3.672234e-21  9.135338e-03  3.274742e-02  1.231200e-21  3.316609e-21
    #> [181]  2.443983e-21  3.194133e-21  1.248038e-21  6.931106e-22  8.763299e-22
    #> [186]  1.537627e-21 -2.079670e-21  2.088803e-21 -3.150448e-21  2.179337e-22
    #> [191]  2.058631e-21 -2.401046e-21  6.522563e-22 -1.525412e-21 -2.161287e-22
    #> [196] -3.282556e-21 -3.177736e-21  2.183440e-21 -4.308984e-22  3.678628e-21
    #> [201]  1.625777e-01 -4.547701e-21  3.955670e-22  4.439611e-21 -9.411719e-02
    #> [206]  5.118164e-21  8.523621e-24  6.196964e-22 -5.678925e-21 -4.102788e-21
    #> [211] -1.446478e-21 -1.348688e-21 -3.707604e-21 -9.864704e-22  4.519310e-21
    #> [216]  1.998165e-21  1.688565e-21  2.345749e-21 -1.857097e-21 -1.310128e-22
    #> [221]  1.972517e-22  2.628842e-21  1.714552e-23  1.526481e-21  1.482220e-21
    #> [226] -2.059391e-21 -3.967125e-22 -4.008056e-21 -1.113656e-21 -5.935424e-03
    #> [231] -2.756705e-21  5.226404e-22 -1.754260e-21 -1.094879e-22  3.053026e-21
    #> [236] -2.472185e-21 -9.445483e-22 -2.874940e-21 -1.649560e-21 -6.893181e-22
    #> [241] -1.278765e-21 -4.217007e-21 -4.946029e-21 -1.266030e-21 -3.157753e-21
    #> [246] -3.099787e-21 -3.095534e-21  3.509083e-21  1.802874e-23  1.445023e-21
    #> [251]  1.780574e-21 -8.353378e-22 -7.334793e-22  4.335025e-21  1.257691e-22
    #> [256] -2.925793e-21 -3.467185e-21  1.234410e-02  3.036695e-21  1.087414e-21
    #> [261]  1.007181e-21  1.139172e-21 -2.531926e-03 -2.030477e-21 -7.188916e-22
    #> [266]  1.293929e-21 -5.029050e-02 -2.062977e-21 -2.671563e-21 -3.112824e-21
    #> [271] -4.635461e-21 -5.443024e-21 -3.811840e-22 -3.041256e-22 -1.005692e-21
    #> [276]  3.791355e-22 -2.319237e-21  4.686752e-03 -3.300075e-21 -2.936359e-22
    #> [281]  1.224680e-21 -7.799541e-22 -7.221560e-22 -1.527515e-21 -5.320945e-21
    #> [286] -8.409493e-22  2.885246e-22 -6.466550e-22  1.700704e-22 -8.530517e-23
    #> [291]  8.138302e-22  2.557236e-21  1.694970e-21  4.278651e-22  2.204645e-21
    #> [296] -5.439652e-22  1.778087e-21 -2.250149e-21  2.074314e-21  9.316706e-22
    #> [301] -1.100733e-21  4.194539e-22  1.586578e-21  6.620131e-23  1.115331e-02
    #> [306]  2.776321e-21  2.114766e-21  1.454497e-21 -1.246901e-21  1.399917e-21
    #> [311] -5.010234e-22  5.814652e-21  1.512193e-21  4.218259e-22 -5.169425e-21
    #> [316]  3.758493e-21 -3.459435e-02 -4.868008e-22 -6.067265e-24  3.898443e-22
    #> [321] -2.510449e-21 -2.913407e-21  3.545345e-22  5.524983e-23  4.801553e-21
    #> [326] -1.103102e-02 -1.795592e-21 -1.829744e-21  9.638766e-22  8.874591e-23
    #> [331]  1.766895e-21 -3.469230e-21  3.469734e-21  1.684858e-21  2.840946e-22
    #> [336]  3.923014e-21  4.995266e-22 -1.563779e-01 -3.577058e-21  9.791645e-02
    #> [341]  1.197775e-23  3.322888e-21  3.499128e-21  1.141561e-22 -2.796319e-21
    #> [346]  2.200713e-21  5.957138e-03 -9.883142e-22 -9.070902e-03 -1.781253e-02
    #> [351] -8.610684e-23 -1.395241e-21  1.257605e-22  4.084340e-21 -4.001073e-21
    #> [356]  5.609119e-21 -3.684762e-21  1.617179e-21  3.147726e-21 -1.360006e-21
    #> [361] -3.385562e-21 -3.079727e-21 -6.065125e-22 -4.779395e-22 -7.049429e-22
    #> [366] -3.898237e-22 -2.811334e-02 -1.216370e-21  3.511017e-22 -1.805779e-21
    #> [371] -1.981737e-21 -1.585472e-21 -1.770218e-21 -2.976165e-22 -2.849536e-21
    #> [376]  4.858968e-21  1.889815e-21 -5.353364e-21 -1.666072e-21 -1.565248e-21
    #> [381]  6.347044e-22 -1.329025e-02 -1.503074e-21 -1.790466e-21  1.919496e-21
    #> [386]  1.483684e-21  2.496690e-21 -4.223030e-22 -5.178845e-21 -3.950403e-21
    #> [391] -3.190498e-21 -6.597739e-22  2.641008e-21 -1.776632e-22 -3.539239e-21
    #> [396]  2.717540e-21  3.758948e-22  6.947119e-22 -3.995124e-21  2.003739e-21

Finding projection direction in high dimensional logistic regression


    n = 50
    p = 400
    X = matrix(sample(-2:2,n*p,replace = TRUE),nrow=n,ncol=p)
    y = rbinom(n,1,0.5)
    col.norm <- 1/sqrt((1/n)*diag(t(X)%*%X)+0.0001);
    Xnor <- X %*% diag(col.norm);
    fit = glmnet::cv.glmnet(Xnor, y, alpha=1,family = "binomial")
    htheta <- as.vector(coef(fit, s = "lambda.min"))
    support<-(abs(htheta)>0.001)
    Xb <- cbind(rep(1,n),Xnor);
    Xc <- cbind(rep(1,n),X);
    col.norm <- c(1,col.norm);
    pp <- (p+1);
    xnew = c(1,rep(0,(p-1)))
    loading=rep(0,pp)
    loading[1]=1
    loading[-1]=xnew
    htheta <- htheta*col.norm;
    htheta <- as.vector(htheta)
    f_prime <- exp(Xc%*%htheta)/(1+exp(Xc%*%htheta))^2

    ## Finding Projection Direction using fixed tuning parameter

    Direction.est <- FIHR::Direction_fixedtuning(X,loading=c(1,rep(0,(p-1))),mu=sqrt(2.01*log(p)/n)*resol^{-(step-1)},model = "logistic",weight = 1/f_prime, deriv.vec = f_prime)
    #> [1] "fixed mu"
    #> [1] 0.2181208
    Direction.est$proj
    #>   [1]  7.200043e-01  3.136470e-22  1.049810e-02  2.138148e-21 -3.468543e-02
    #>   [6] -2.593601e-22 -3.126133e-22  2.711646e-21 -5.203207e-22  4.973396e-22
    #>  [11] -2.664914e-21 -5.326527e-22 -1.596793e-21 -2.317638e-21 -8.025274e-22
    #>  [16] -3.034857e-22 -5.698743e-22 -6.274392e-22  1.625802e-21 -2.029335e-21
    #>  [21] -1.749718e-21 -2.879810e-22  1.996453e-22 -1.361326e-22 -2.920252e-22
    #>  [26]  1.224118e-21  5.162589e-22  1.582207e-22  9.409236e-22 -1.134564e-21
    #>  [31]  1.439104e-21  6.609688e-22 -2.224340e-22  7.663297e-23  1.591790e-21
    #>  [36] -4.636867e-22 -5.026762e-22  8.494790e-22  1.579990e-21 -3.730787e-22
    #>  [41] -1.697928e-21  1.622556e-21  1.017398e-21  1.393847e-21 -2.372676e-02
    #>  [46]  1.192158e-21  2.225733e-22  8.216756e-22 -7.324308e-22  6.820857e-22
    #>  [51] -1.524280e-21  3.351380e-22 -5.252232e-23  3.114686e-21 -1.014999e-21
    #>  [56]  1.955135e-21 -1.558306e-21 -1.908542e-21  8.549299e-22  1.540185e-21
    #>  [61] -1.380253e-22  1.442238e-21  1.953238e-21  8.082128e-02 -1.890253e-22
    #>  [66]  1.183969e-21 -1.651324e-21  7.788577e-22  2.109472e-22  2.023183e-22
    #>  [71] -2.481335e-22 -4.124347e-22  2.722147e-22  9.197452e-22 -5.262456e-22
    #>  [76]  3.430993e-23 -2.370394e-22  6.119199e-22 -3.436519e-22 -1.703944e-22
    #>  [81] -1.027532e-21  3.274511e-22  8.845793e-22 -1.113108e-21 -5.789883e-23
    #>  [86]  4.342176e-22  2.205156e-23  2.363144e-21 -1.161798e-21 -1.057501e-23
    #>  [91]  1.148969e-21 -2.199528e-22  6.334047e-22  7.306685e-22 -7.759149e-22
    #>  [96] -6.792961e-22  8.954813e-22 -1.430994e-23  2.759375e-22  4.161299e-22
    #> [101] -4.870783e-22 -8.350589e-22 -4.738592e-23  9.324983e-22 -9.517856e-23
    #> [106]  1.979545e-22 -9.103739e-22 -4.342574e-03  1.674866e-21  1.984500e-21
    #> [111]  5.038455e-22 -1.897575e-21 -6.023592e-22  3.777075e-22  1.494271e-21
    #> [116] -8.649763e-22 -1.075864e-21  1.395203e-21  5.893592e-22  2.655745e-22
    #> [121]  1.038974e-21 -6.425078e-23 -4.587937e-22 -7.515732e-23 -2.388996e-22
    #> [126] -1.262500e-21 -1.597353e-21 -1.272640e-22  1.437182e-21 -2.284015e-22
    #> [131]  1.010515e-21  4.089558e-22 -2.085802e-21 -8.229783e-22  7.630252e-22
    #> [136] -8.932831e-23  1.202275e-21  1.054013e-22  1.309794e-21 -1.762213e-21
    #> [141]  5.605567e-22 -1.163615e-21  1.429300e-21  1.589619e-21  7.792687e-22
    #> [146]  5.729945e-22 -1.012349e-22 -4.523851e-22  2.263101e-21 -5.817699e-22
    #> [151] -2.596130e-22  2.435645e-22 -1.376463e-22 -1.124933e-21 -9.247785e-22
    #> [156] -1.920081e-21 -2.314596e-21  3.611564e-03  2.477324e-21 -2.639997e-02
    #> [161] -1.152408e-21 -1.299006e-21 -5.359833e-22  6.913906e-22 -5.432081e-22
    #> [166] -1.232272e-21 -5.158049e-02 -1.996083e-21  1.869492e-21 -1.666425e-21
    #> [171] -8.178206e-03 -7.555921e-22 -9.920654e-22 -2.031201e-23  6.095097e-22
    #> [176] -5.167046e-22 -3.549751e-22  5.487308e-25  1.994568e-22  6.591553e-22
    #> [181]  6.482703e-23 -5.798969e-22 -5.392306e-22 -7.958977e-22 -1.868651e-21
    #> [186]  9.874673e-22  6.619078e-22 -5.095344e-22  3.950207e-23  2.599700e-02
    #> [191] -2.225953e-22  1.574079e-21  5.113933e-22  1.444996e-21 -1.895018e-21
    #> [196] -2.152917e-22 -1.076962e-21 -4.463184e-22  1.109781e-21  6.613264e-23
    #> [201] -2.336820e-22 -4.297455e-22  4.611184e-22  1.008831e-21 -3.890447e-23
    #> [206] -2.831324e-02  5.533165e-22  1.158165e-21  8.219153e-22 -1.032229e-21
    #> [211]  2.524686e-21 -3.210048e-22  2.576743e-02 -7.852756e-22 -3.672519e-22
    #> [216]  4.900086e-02 -1.634339e-22  1.594170e-21  1.254645e-21  9.540335e-22
    #> [221] -1.106930e-21 -1.102944e-22 -6.751988e-22  2.624703e-22  8.587593e-02
    #> [226] -1.056279e-01 -1.386204e-21  2.385170e-21  1.070135e-21  9.295570e-22
    #> [231]  1.172322e-21 -1.638629e-21  1.040106e-21 -7.565294e-23 -1.172783e-21
    #> [236]  8.805487e-22  1.066539e-21  3.476667e-02 -1.242916e-22 -1.335350e-21
    #> [241]  6.419672e-23 -4.065595e-22 -5.759792e-22  5.813861e-22 -2.764126e-02
    #> [246] -3.219059e-22  4.391599e-22 -4.448588e-22 -1.161529e-22  5.155654e-22
    #> [251] -1.061937e-21  9.560434e-22 -1.274809e-22  1.383037e-21  6.570182e-22
    #> [256]  8.524472e-22 -6.460664e-22  5.417119e-22 -1.212430e-02  2.918937e-02
    #> [261] -4.852307e-23  1.626025e-22 -1.748327e-21  1.004347e-21 -9.004087e-22
    #> [266] -4.446802e-22  1.138067e-21 -1.091842e-02 -1.165630e-21 -6.612985e-22
    #> [271] -6.417278e-22 -8.845622e-22 -9.210408e-22 -1.303277e-21  2.178826e-21
    #> [276]  4.156162e-22  1.588155e-21  9.516323e-23 -1.595956e-22 -1.310362e-21
    #> [281]  2.640358e-21 -5.161299e-22  7.283259e-22 -1.518791e-21 -2.681659e-22
    #> [286]  2.996278e-02 -7.731528e-22 -6.465389e-22  3.514791e-22  1.363613e-21
    #> [291] -9.946412e-22 -7.139185e-22  2.531541e-22  2.539527e-22  5.469716e-23
    #> [296] -2.844693e-21  9.432056e-22  2.157689e-21  9.273077e-23 -1.019008e-21
    #> [301] -1.103281e-21 -5.717531e-22 -1.914831e-22  9.147424e-22  6.638341e-22
    #> [306]  3.114459e-02 -1.617884e-21 -5.269851e-22 -1.951209e-22  4.134578e-22
    #> [311] -7.337744e-03 -7.449669e-22  8.343895e-22  5.518749e-22  4.919855e-22
    #> [316] -1.347154e-21 -2.725105e-22 -8.275767e-22  1.280978e-02  1.052655e-21
    #> [321]  1.842114e-21  1.339178e-21  3.472074e-22  2.412083e-21 -1.440699e-21
    #> [326] -7.056624e-22  2.132108e-22 -1.053334e-22  9.609274e-22  8.880815e-22
    #> [331] -9.292623e-22 -4.983241e-22  1.742855e-21 -8.357460e-22  1.401689e-21
    #> [336] -1.120494e-22 -1.168712e-21 -1.013268e-21  2.261363e-21 -8.484131e-22
    #> [341]  1.331692e-21 -1.833653e-22  1.281788e-21 -4.768610e-22  7.748087e-22
    #> [346]  9.854261e-22  1.639746e-22  9.434637e-23  3.619198e-22 -1.273019e-21
    #> [351] -4.528917e-22  2.062375e-21  2.271781e-22 -7.933488e-22  1.717202e-21
    #> [356] -6.356024e-22  3.251702e-02 -2.891901e-22  1.277235e-02  1.201610e-23
    #> [361] -5.020637e-22  8.812446e-22 -1.303791e-21  1.167968e-21 -2.127430e-02
    #> [366] -9.871470e-22 -9.976346e-22  1.886428e-21  1.607224e-02  6.922461e-22
    #> [371] -5.242053e-22  9.839155e-22  6.420461e-22 -2.374761e-22  4.542349e-22
    #> [376] -1.316194e-22  2.140144e-22 -1.757484e-22  2.315463e-22  3.283616e-22
    #> [381]  7.177085e-22  4.265133e-03  6.260868e-22 -3.694741e-22 -3.358994e-23
    #> [386]  2.126198e-21 -5.943484e-03 -1.694006e-22  2.159414e-21 -2.131670e-22
    #> [391] -1.127753e-21 -1.468467e-21  1.597845e-22 -7.324099e-22 -8.145717e-22
    #> [396] -1.183468e-21 -4.541361e-22  5.293333e-22 -6.038252e-22 -6.192073e-22

    ## Finding Projection Direction using best step size


    Direction.est <- FIHR::Direction_searchtuning(Xc,loading,model = "logistic",weight = 1/f_prime, deriv.vec = f_prime)
    #> [1] 2
    Direction.est$proj
    #>   [1]  3.703118e-01  3.200308e-01  2.624989e-22  5.433080e-22 -2.825677e-23
    #>   [6] -3.978922e-22 -2.657625e-22 -1.276195e-22  1.453397e-22 -2.394240e-22
    #>  [11]  2.803681e-22  4.306008e-23  1.374006e-22 -2.663511e-22 -8.933797e-23
    #>  [16]  1.301834e-23  1.641591e-22  1.095244e-22  4.140178e-23  5.155950e-23
    #>  [21] -3.382998e-22  1.767603e-23 -1.139000e-22  5.899087e-23  3.865917e-22
    #>  [26] -5.876938e-22 -1.723621e-22  3.522102e-22 -2.102418e-22  1.592552e-22
    #>  [31] -4.118958e-22  1.356629e-22 -9.847435e-23  8.693946e-23  1.049291e-22
    #>  [36] -1.353670e-22  3.666747e-22 -2.620599e-22 -4.996745e-23  3.206203e-22
    #>  [41] -1.585696e-22 -2.518301e-22  2.934779e-22  4.581305e-22  5.466000e-24
    #>  [46] -3.852031e-22  2.045794e-22 -2.019938e-22  1.511088e-22 -4.105085e-22
    #>  [51] -9.344096e-23 -3.754938e-22 -5.626666e-23  1.901291e-23  1.637116e-23
    #>  [56]  4.956110e-22 -2.467186e-22 -1.693078e-22 -2.954204e-22  1.083315e-22
    #>  [61] -2.569903e-22 -2.011207e-22  1.151416e-22  1.800698e-22  3.631612e-22
    #>  [66]  1.007570e-22  2.099670e-22 -1.443545e-22  2.553039e-22  9.975718e-23
    #>  [71]  3.207257e-23 -3.707121e-22 -2.038465e-22  4.019415e-22  1.881323e-22
    #>  [76] -1.020390e-22 -1.157586e-22 -2.562807e-22  3.239125e-22  1.176534e-22
    #>  [81]  1.108029e-22 -1.540886e-22  1.849103e-22 -1.307332e-23  2.697282e-22
    #>  [86] -2.797564e-22  2.651050e-22  1.935916e-22  6.694971e-23 -1.853921e-22
    #>  [91]  1.041250e-22  1.198469e-22 -2.311859e-22  1.114777e-22 -7.454591e-23
    #>  [96]  4.235590e-22 -4.818592e-23 -5.020800e-23 -1.705871e-22 -2.201612e-22
    #> [101] -2.473971e-23 -7.188431e-23 -6.024308e-22  1.157664e-22  1.480895e-22
    #> [106]  1.375256e-22 -1.376237e-22  4.967455e-23 -4.893595e-22  7.008844e-23
    #> [111] -1.025402e-22 -5.226704e-23  4.326347e-22 -1.863619e-22  1.437762e-22
    #> [116] -5.436466e-23  6.197526e-23 -9.572994e-23  1.375787e-22  1.227333e-22
    #> [121]  1.199161e-22  6.864657e-23  2.323406e-22  6.768695e-23 -7.805601e-23
    #> [126] -3.165607e-23 -4.267615e-22 -4.096933e-23 -3.086778e-22  2.806894e-22
    #> [131] -2.210305e-22  3.745337e-22  3.834054e-22  4.927118e-23  4.514483e-22
    #> [136]  1.141757e-22  2.107265e-22  8.684388e-23  7.406213e-23 -3.581604e-22
    #> [141]  1.163947e-22  1.662767e-22 -3.932388e-22  2.177262e-22  4.216020e-22
    #> [146] -2.980070e-22  2.004995e-22 -1.273042e-22 -2.869312e-22 -5.427380e-24
    #> [151]  6.236627e-24 -3.003664e-22  1.269979e-22 -1.382703e-22  1.240001e-22
    #> [156] -1.937464e-22 -2.107413e-22 -5.141956e-23  3.917303e-22  7.872115e-23
    #> [161] -5.025574e-22 -4.586084e-23  7.886753e-23 -2.180345e-22 -5.771002e-24
    #> [166]  3.279104e-22 -9.657873e-23 -4.281925e-22 -1.958037e-22  2.335044e-22
    #> [171] -7.862881e-23 -4.287325e-22  4.743905e-22  8.096866e-24  2.565137e-22
    #> [176]  3.571933e-23  6.538812e-23 -4.834043e-22  3.432353e-22  2.882400e-22
    #> [181]  6.289587e-23 -3.539030e-24 -1.996998e-22 -4.174704e-23 -3.303063e-22
    #> [186]  2.008953e-22  1.470272e-22 -4.811177e-22  1.060116e-22 -2.323871e-22
    #> [191]  5.298163e-22 -1.971449e-22  4.553980e-22 -1.685395e-22 -1.419096e-22
    #> [196] -1.911433e-23 -9.514328e-23 -2.066955e-22 -3.313360e-22  3.676265e-22
    #> [201] -2.899435e-22 -2.092910e-22 -3.105357e-22  1.580357e-22  2.001751e-22
    #> [206]  8.526115e-23 -6.347223e-22  9.183927e-23 -1.972141e-22 -2.791444e-22
    #> [211] -2.706081e-22 -6.061754e-24 -1.002326e-23  6.201409e-22 -1.263570e-22
    #> [216]  1.945659e-22  6.802769e-22  4.893315e-22  1.980559e-22 -1.211449e-22
    #> [221] -1.121008e-22  5.524507e-23  3.580071e-22  1.834046e-22  4.176143e-22
    #> [226]  7.828894e-22 -9.575095e-03  9.781104e-25 -9.315277e-23 -3.659817e-23
    #> [231] -1.197765e-22  7.804370e-23  5.988861e-23  5.913823e-23  2.385702e-22
    #> [236] -1.181235e-22 -3.010378e-22 -3.068271e-22  4.133426e-22  1.472480e-22
    #> [241]  1.384703e-22  1.954670e-23 -6.901831e-23  1.571037e-22  1.641289e-22
    #> [246] -5.384227e-22  4.476251e-22  2.822840e-22 -3.429629e-22  1.987666e-22
    #> [251] -1.847824e-22  3.227390e-22 -2.750627e-22  1.540887e-22  2.633280e-22
    #> [256]  1.926789e-23  7.437713e-23  2.489606e-22  2.533267e-23 -3.483233e-22
    #> [261]  3.801687e-22 -7.621416e-24 -1.676589e-22 -1.927873e-22  1.590509e-22
    #> [266] -9.330095e-23  5.127258e-23 -1.438931e-22 -5.248717e-22 -3.251211e-22
    #> [271]  1.400310e-22 -1.959625e-22 -1.662030e-22  1.069540e-22 -1.708695e-22
    #> [276]  6.728509e-23 -2.630574e-22  3.111134e-22 -1.570747e-23 -9.781131e-23
    #> [281]  3.177958e-23  2.096953e-22 -2.267451e-22  2.980631e-23  1.065261e-22
    #> [286]  2.575963e-23  3.576717e-22 -2.621746e-22  1.756242e-24 -2.230003e-22
    #> [291]  6.859210e-23 -2.969326e-22  2.932318e-23 -1.027280e-22 -1.058849e-22
    #> [296] -8.333450e-23 -1.318905e-22  2.817403e-22  2.046472e-22  1.649365e-23
    #> [301]  1.686567e-22 -9.099782e-23 -2.399946e-22 -1.632299e-22  2.426391e-23
    #> [306]  1.000181e-22  3.270867e-22  2.608881e-22 -5.965684e-23  2.100889e-22
    #> [311]  2.863474e-23 -3.605256e-22  6.882923e-23 -2.047607e-22  2.922155e-22
    #> [316] -2.529582e-22  4.047944e-23 -3.702745e-22 -3.608265e-23  6.505094e-22
    #> [321]  1.394017e-22 -1.143603e-22  1.931609e-22  9.105546e-23 -1.841322e-22
    #> [326] -2.163589e-22  3.858654e-23 -1.040142e-22  1.917836e-22  3.070270e-22
    #> [331] -2.017051e-22  2.743990e-22  6.724641e-23 -2.018364e-22 -3.566654e-22
    #> [336] -5.715241e-22 -2.471397e-23 -4.957885e-23 -1.201047e-22 -3.317502e-22
    #> [341] -1.091200e-22  2.545576e-22 -8.663777e-23  3.895362e-22 -1.731681e-22
    #> [346] -9.491368e-23  1.775360e-23  4.559605e-23 -3.068887e-22 -1.481983e-22
    #> [351] -1.995012e-22 -1.464241e-22  1.652567e-22  6.569675e-23 -3.036945e-23
    #> [356] -1.232220e-22 -3.632201e-23  3.371400e-22 -6.918901e-23  5.237252e-22
    #> [361]  2.779631e-23  9.240406e-23 -2.763428e-23  1.927132e-22  4.070390e-22
    #> [366] -2.063237e-22  4.208875e-22 -4.114991e-22  1.746941e-22  3.965246e-22
    #> [371]  1.507647e-22  2.066116e-22  1.182773e-22 -2.711577e-22 -2.999010e-22
    #> [376] -3.791140e-22  3.443444e-22  8.289486e-23 -5.492270e-23 -5.466934e-22
    #> [381] -1.815244e-22  2.287935e-22  3.555637e-22 -9.535881e-23  1.636018e-22
    #> [386] -7.907247e-24  2.877399e-22 -4.727876e-22  1.112859e-22 -2.933440e-22
    #> [391] -1.812016e-22 -1.069736e-22  1.640403e-22 -1.691080e-22  1.045556e-22
    #> [396] -2.536272e-22  3.708136e-22 -1.751050e-22  2.217325e-22  2.019242e-23
    #> [401] -2.149619e-22

Inference for difference of linear functionals in high dimensional
linear regression


    n1 = 100
    p = 400
    n2 = 150
    A1gen <- function(rho,p){
    A1=matrix(0,p,p)
    for(i in 1:p){
    for(j in 1:p){
      A1[i,j]<-rho^(abs(i-j))
    }
    }
    A1
    }
    mu <- rep(0,p)
    mu[1:5] <- c(1:5)/5
    rho = 0.5
    Cov <- (A1gen(rho,p))/2
    Cov2<-matrix(NA,nrow=p,ncol=p)
    for(i in 1:p){
    for(j in 1:p){
      Cov2[i,j]<-0.5^(1+abs(i-j))
    }
    }
    beta1 <- rep(0,p)
    beta1[1:10] <- c(1:10)/5
    beta2 <- rep(0,p)
    beta2[1:5] <- c(1:5)/10
    X1 <- MASS::mvrnorm(n1,mu,Cov)
    X2 <- MASS::mvrnorm(n2,mu,Cov)
    y1 = X1%*%beta1 + rnorm(n1)
    y2 = X2%*%beta2 + rnorm(n2)
    loading <- MASS::mvrnorm(1,rep(0,p),Cov2)
    Est <- FIHR::ITS(X1 = X1, y1 = y1, X2 = X2, y2 = y2,loading = loading, intercept = TRUE)
    #> [1] 3
    #> [1] 3
    #> [1] 3
    #> [1] "step is 3"
    #> [1] "fixed mu"
    #> [1] 0.1542668
    #> [1] 3
    #> [1] 3
    #> [1] 3
    #> [1] "step is 3"
    #> [1] "fixed mu"
    #> [1] 0.1259583
    Est$prop.est
    #>          [,1]
    #> [1,] 1.229182
    Est$se
    #> [1] 2.166304

Inference for difference of case probabilities in high dimensional
logistic regression

    A1gen <- function(rho,p){
    A1=matrix(0,p,p)
    for(i in 1:p){
     for(j in 1:p){
       A1[i,j]<-rho^(abs(i-j))
     }
    }
    A1
    }
    n1 = 100
    n2 = 200
    p = 400
    mu <- rep(0,p)
    rho = 0.5
    Cov <- (A1gen(rho,p))/2
    Cov2<-matrix(NA,nrow=p,ncol=p)
    for(i in 1:p){
     for(j in 1:p){
       Cov2[i,j]<-0.5^(1+abs(i-j))
     }
    }

    beta1 <- rep(0,p)
    beta1[1:10] <- c(1:10)/5
    beta2 <- rep(0,p)
    beta2[1:5] <- c(1:5)/10
    X1 <- MASS::mvrnorm(n1,mu,Cov)
    X2 <- MASS::mvrnorm(n2,mu,Cov)
    exp_val1 <- X1%*%beta1
    exp_val2 <- X2%*%beta2
    prob1 <- exp(exp_val1)/(1+exp(exp_val1))
    prob2 <- exp(exp_val2)/(1+exp(exp_val2))
    y1 <- rbinom(n1,1,prob1)
    y2 <- rbinom(n2,1,prob2)
    loading <- MASS::mvrnorm(1,mu,Cov2)
    Est <- FIHR::ITS_Logistic(X1 = X1, y1 = y1, X2 = X2, y2 = y2,loading = loading, intercept = TRUE)
    #> [1] 3
    #> [1] 3
    #> [1] 3
    #> [1] "step is 3"
    #> [1] "fixed mu"
    #> [1] 0.1542668
    #> [1] 3
    #> [1] 3
    #> [1] 3
    #> [1] "step is 3"
    #> [1] "fixed mu"
    #> [1] 0.1090831
    Est$prop.est
    #> [1] -0.09157908
    Est$se
    #> [1] 0.2320372
