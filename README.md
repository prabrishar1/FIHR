
<!-- README.md is generated from README.Rmd. Please edit that file -->

FIHR
====

<!-- badges: start -->
<!-- badges: end -->

The goal of FIHR is to provide inference for linear and quadratic
functionals in high-dimensional linear and logistic regression models.
It computes bias-corrected estimators and corresponding standard errors
for the linear and quadratic functionals.

Installation
------------

You can install the development version from
[GitHub](https://github.com/) with:

    # install.packages("devtools")
    devtools::install_github("prabrishar1/FIHR")

Example
-------

These are basic examples which show how to solve the common
high-dimensional inference problems:

    library(FIHR)

Inference for linear functional in high-dimensional linear regression
model


    library(MASS)
    n = 100
    p = 400
    A1gen <- function(rho,p){
      A1=matrix(0,p,p)
      for(i in 1:p){
        for(j in 1:p){
          A1[i,j]<-rho^(abs(i-j))
        } 
      }
      A1
    }
    mu <- rep(0,p)
    mu[1:5] <- c(1:5)/5
    rho = 0.5
    Cov <- (A1gen(rho,p))/2
    Cov2<-matrix(NA,nrow=p,ncol=p)
    for(i in 1:p){
        for(j in 1:p){
        Cov2[i,j]<-0.5^(1+abs(i-j))
        } 
      }
    beta <- rep(0,p)
    beta[1:10] <- c(1:10)/5
    X <- MASS::mvrnorm(n,mu,Cov)
    y = X%*%beta + rnorm(n)
    loading <- MASS::mvrnorm(1,rep(0,p),Cov2)
    Est = FIHR::LF(X = X, y = y, loading = loading, intercept = TRUE)
    #> [1] 3
    #> [1] 3
    #> [1] 2
    #> [1] "step is 3"
    #> [1] "fixed mu"
    #> [1] 0.1542668
    Est$prop.est
    #>           [,1]
    #> [1,] -4.581912
    Est$se
    #> [1] 3.004807

Inference for linear functional in high-dimensional logistic regression
model

    library(MASS)
    A1gen <- function(rho,p){
      A1=matrix(0,p,p)
      for(i in 1:p){
        for(j in 1:p){
          A1[i,j]<-rho^(abs(i-j))
        } 
      }
      A1
    }
    n = 100
    p = 400
    mu <- rep(0,p)
    rho = 0.5
    Cov <- (A1gen(rho,p))/2
    Cov2<-matrix(NA,nrow=p,ncol=p)
    for(i in 1:p){
        for(j in 1:p){
        Cov2[i,j]<-0.5^(1+abs(i-j))
        } 
      }
    beta <- rep(0,p)
    beta[1:10] <-0.5*c(1:10)/10
    X <- MASS::mvrnorm(n,mu,Cov)
    exp_val <- X%*%beta
    prob <- exp(exp_val)/(1+exp(exp_val))
    y <- rbinom(n,1,prob)
    loading <- MASS::mvrnorm(1,mu,Cov2)
    Est = FIHR::LF_logistic(X = X, y = y, loading = loading, intercept = TRUE, weight = rep(1,n))
    #> [1] 3
    #> [1] 3
    #> [1] 3
    #> [1] "step is 3"
    #> [1] "fixed mu"
    #> [1] 0.1542668
    #> [1] "The null hypothesis claiming the case probability = 0.5, is accepted"
    Est$prop.est
    #> [1] 0.03603207
    Est$se
    #> NULL

Inference for quadratic functional in high-dimensional linear model


    library(MASS)
    A1gen <- function(rho,p){
      A1=matrix(0,p,p)
      for(i in 1:p){
        for(j in 1:p){
          A1[i,j]<-rho^(abs(i-j))
        } 
      }
      A1
    }
    rho = 0.6
    Cov <- (A1gen(rho,400))
    mu <- rep(0,400)
    mu[1:5] <- c(1:5)/5
    beta <- rep(0,400)
    beta[25:50] <- 0.08
    X <- MASS::mvrnorm(100,mu,Cov)
    y <- X%*%beta + rnorm(100)
    test.set <- c(30:100)

    ## Inference for Quadratic Functional with Population Covariance Matrix in middle

    Est = FIHR::QF(X = X, y = y, G=test.set)
    #> [1] 5
    #> [1] 5
    #> [1] 5
    #> [1] "fixed mu"
    #> [1] 0.1421723
    #> [1] "step is 5"
    #> Warning in FIHR::QF(X = X, y = y, G = test.set): The model is most likely
    #> misspecified because the correction term is larger than the lasso estimate in
    #> absolute value. See cluster or group: X30, X31, X32, X33, X34, X35, X36, X37,
    #> X38, X39, X40, X41, X42, X43, X44, X45, X46, X47, X48, X49, X50, X51, X52, X53,
    #> X54, X55, X56, X57, X58, X59, X60, X61, X62, X63, X64, X65, X66, X67, X68, X69,
    #> X70, X71, X72, X73, X74, X75, X76, X77, X78, X79, X80, X81, X82, X83, X84, X85,
    #> X86, X87, X88, X89, X90, X91, X92, X93, X94, X95, X96, X97, X98, X99, X100 . The
    #> value of the lasso.plugin and correction are 0.16329 respectively 0.17134 .
    Est$prop.est
    #>           [,1]
    #> [1,] 0.3346308
    Est$se
    #> [1] 0.1162061

    ## Inference for Quadratic Functional with known matrix A in middle

    Est = FIHR::QF(X = X, y = y, G=test.set, Cov.weight = FALSE,A = diag(1:400,400))
    #> [1] 5
    #> [1] 5
    #> [1] 5
    #> [1] "fixed mu"
    #> [1] 0.1421723
    #> [1] "step is 5"
    Est$prop.est
    #>          [,1]
    #> [1,] 5.011334
    Est$se
    #> [1] 1.363998

    ## Inference for square norm of regression vector

    Est = FIHR::QF(X = X, y = y, G=test.set, Cov.weight = FALSE,A = diag(1,400))
    #> [1] 5
    #> [1] 5
    #> [1] 5
    #> [1] "fixed mu"
    #> [1] 0.1421723
    #> [1] "step is 5"
    Est$prop.est
    #>           [,1]
    #> [1,] 0.1470217
    Est$se
    #> [1] 0.07665071

Finding projection direction in high dimensional linear regression


    n = 100
    p = 400
    X = matrix(sample(-2:2,n*p,replace = TRUE),nrow = n,ncol = p)
    resol = 1.5
    step = 3

    ## Finding Projection Direction using fixed tuning parameter

    Direction.est <- FIHR::Direction_fixedtuning(X,loading=c(1,rep(0,(p-1))),mu=sqrt(2.01*log(p)/n)*resol^{-(step-1)})
    #> [1] "fixed mu"
    #> [1] 0.1542347
    Direction.est$proj
    #>   [1]  8.831247e-01  2.702723e-21 -8.224483e-22 -3.976043e-02  2.760098e-21
    #>   [6]  1.960333e-21  1.976536e-21 -6.189488e-21 -5.758550e-21  5.094255e-05
    #>  [11] -2.542567e-22 -6.355036e-21 -1.300777e-02 -1.552183e-21  2.275629e-02
    #>  [16] -2.808350e-21  2.664716e-21  1.657700e-21  1.088787e-01  6.147019e-21
    #>  [21] -4.478970e-21  7.281644e-02  7.226959e-23 -5.370140e-02  1.461507e-22
    #>  [26] -1.796712e-21 -5.952231e-21  4.505996e-21  3.299933e-21 -4.024147e-21
    #>  [31] -2.926104e-02  3.778992e-21 -6.312302e-03 -1.457564e-21 -6.027981e-22
    #>  [36] -7.643556e-22 -3.590505e-21 -1.679190e-21 -6.464845e-21  3.346532e-21
    #>  [41] -2.984315e-21 -5.151239e-21 -6.507031e-22  2.664744e-21  6.373087e-21
    #>  [46] -4.750399e-21  7.160329e-21 -2.334309e-22  7.990145e-21 -3.251789e-02
    #>  [51]  2.925136e-21  1.727795e-21 -5.208469e-21 -7.162729e-03  4.518706e-21
    #>  [56] -1.302913e-21  1.450209e-21 -3.033423e-21  1.594655e-21 -3.332336e-21
    #>  [61]  7.999630e-21  2.720802e-21  2.250038e-21  3.839354e-21  1.184367e-02
    #>  [66]  3.197440e-21 -6.483217e-21  3.266825e-21 -2.925524e-21 -4.767468e-21
    #>  [71]  1.137750e-21 -5.917069e-21  4.064634e-21 -6.869282e-21 -7.260670e-21
    #>  [76]  7.693917e-22  1.344000e-02 -1.323460e-21  5.367185e-02  4.129974e-21
    #>  [81]  2.642602e-21 -9.482866e-22 -3.361979e-21 -3.493512e-21 -1.908952e-21
    #>  [86] -1.847686e-02  5.088578e-22 -2.366987e-21  8.688396e-22 -4.726863e-21
    #>  [91] -3.280309e-21 -3.595922e-22  4.967001e-02  4.263003e-22 -2.989922e-21
    #>  [96]  1.176591e-21 -4.947739e-21  2.847377e-02  1.991935e-21 -4.093758e-21
    #> [101]  2.184115e-21  4.009829e-21  3.476573e-03 -1.668183e-21 -7.910067e-22
    #> [106]  4.001717e-21 -4.990704e-21  7.952043e-21 -1.341291e-01  8.000583e-22
    #> [111]  7.232220e-21  4.971050e-21  2.799258e-21  2.288771e-22  7.257768e-22
    #> [116]  1.905587e-21 -2.714831e-21 -9.901525e-22  2.201617e-21  5.398521e-21
    #> [121] -3.161107e-21  5.470372e-22  1.602846e-22  3.821907e-21  3.493242e-21
    #> [126] -8.336098e-21 -1.704472e-21  1.549929e-21  5.086035e-21  2.333045e-21
    #> [131]  2.486661e-22 -1.402938e-21  5.877185e-21 -5.605326e-21 -2.767423e-21
    #> [136] -4.709408e-21 -1.534559e-03  4.650114e-21 -2.398323e-21 -1.018176e-22
    #> [141] -1.959090e-21  5.803876e-21  5.300946e-21  2.770800e-21  2.817542e-21
    #> [146] -4.679839e-21 -4.738220e-21 -6.998367e-22 -1.395042e-21 -2.022068e-02
    #> [151] -2.001077e-21 -2.261176e-21 -2.054346e-22  3.749598e-21  6.555637e-22
    #> [156] -1.092116e-21 -2.848773e-21  1.683207e-21 -2.953861e-22 -6.963908e-22
    #> [161] -1.115023e-21  5.117455e-21  2.218330e-21 -4.729419e-22 -5.112938e-21
    #> [166]  1.517903e-21  8.150375e-21  4.194666e-21 -1.219569e-21  5.929618e-21
    #> [171]  1.280805e-21 -5.774742e-21 -2.126670e-21  8.237184e-21 -9.379532e-22
    #> [176] -3.047205e-21 -7.103024e-21 -3.881587e-21 -5.352429e-22 -2.256014e-21
    #> [181] -3.030235e-21  3.815482e-21 -2.683350e-21  8.043232e-02  2.574359e-02
    #> [186] -5.545550e-22  1.811590e-21 -1.752180e-21  5.253497e-21 -1.191155e-01
    #> [191]  5.956651e-21 -3.314652e-21  1.059637e-20  5.385690e-21  4.054997e-22
    #> [196] -2.185648e-21 -4.544250e-21 -1.748565e-21  1.430916e-22  3.263935e-21
    #> [201] -5.388133e-22 -3.967546e-21  1.164041e-21 -1.147006e-21 -6.475447e-21
    #> [206]  1.855595e-21 -1.631632e-21 -6.565023e-21  7.047485e-22 -1.982488e-21
    #> [211]  8.768530e-21  1.357428e-02 -3.743725e-22 -4.324209e-21 -1.897203e-21
    #> [216] -4.334468e-21  2.936612e-22  3.981348e-21  7.971851e-22 -5.055216e-21
    #> [221]  6.167520e-21 -9.569333e-21  4.838745e-21  5.368062e-02 -1.121033e-01
    #> [226] -1.687775e-21 -3.433405e-21  5.836922e-21  3.996192e-21  3.959580e-21
    #> [231] -7.785277e-21  1.387486e-21  4.663618e-21  5.127215e-21 -2.125554e-21
    #> [236]  9.797892e-21 -2.610977e-21 -8.183839e-21 -8.911394e-22  3.572979e-21
    #> [241]  2.433063e-02  6.463301e-22 -2.315163e-21 -3.663817e-21 -1.403854e-21
    #> [246] -1.763155e-21  7.254424e-21 -2.282292e-21 -3.982689e-21 -4.620006e-21
    #> [251] -4.329943e-21 -1.535722e-21 -3.207606e-21 -1.220911e-02 -8.430298e-22
    #> [256]  7.049039e-22  9.076287e-22 -1.285381e-21 -1.978201e-21  9.928760e-22
    #> [261] -7.633208e-21 -3.341628e-21 -4.564312e-02 -1.077631e-21  1.390838e-21
    #> [266] -2.866050e-21 -2.453756e-21  7.340127e-22  6.383441e-03  1.243391e-01
    #> [271]  2.448183e-21  2.565148e-21 -1.044423e-21  1.929045e-21 -3.144659e-21
    #> [276] -3.636083e-21  5.111714e-21 -1.938204e-21  4.322039e-21  6.655029e-03
    #> [281] -1.834409e-21  1.110515e-22 -6.492179e-22  3.945893e-22 -1.656651e-21
    #> [286]  2.941693e-21  5.030580e-21  5.907505e-22  1.731009e-21  4.852886e-21
    #> [291]  6.203902e-21 -4.084166e-21  3.188965e-21 -1.302510e-21  2.354206e-21
    #> [296]  3.088441e-21 -5.258918e-02  2.578390e-21  1.067645e-02  1.224195e-21
    #> [301] -1.016322e-22 -3.503040e-21  3.129455e-02  3.602160e-21  1.407501e-21
    #> [306] -4.983719e-21  3.226262e-23  5.694543e-22  1.498476e-02  1.306778e-21
    #> [311] -9.989441e-22 -4.530385e-22 -2.694499e-21  9.601553e-22 -1.068245e-21
    #> [316] -2.331756e-23  2.985847e-21  1.441915e-21 -7.517457e-21 -2.514172e-21
    #> [321]  6.439013e-21  2.442235e-21  4.190334e-21  3.909054e-21  2.128774e-21
    #> [326]  5.613152e-21  1.422821e-21  3.183606e-21 -2.347011e-21  2.965947e-21
    #> [331] -9.490500e-22  5.812365e-21  3.414968e-21  4.470386e-21  5.247299e-02
    #> [336]  3.447097e-22 -7.264005e-21 -1.967495e-21 -3.374887e-21  2.831648e-21
    #> [341]  2.161485e-21  2.099649e-22  9.166332e-21  1.076985e-02 -6.370034e-21
    #> [346]  4.859496e-22  4.448328e-21 -8.690574e-21 -7.689831e-02  4.067624e-22
    #> [351]  8.303934e-21 -5.087849e-21 -1.728537e-21  5.780184e-21 -8.255874e-03
    #> [356]  2.390839e-21  6.127594e-22 -1.341296e-21  1.652940e-21  2.337248e-21
    #> [361]  2.736046e-22 -3.692582e-22  2.330586e-23  6.157232e-03 -4.928652e-21
    #> [366]  2.849995e-21 -1.556458e-21 -4.434490e-21 -5.667914e-21  1.275803e-02
    #> [371]  1.028308e-21  4.003003e-02  7.182925e-21 -9.794004e-22 -3.284132e-21
    #> [376] -1.312816e-02 -1.976273e-21 -6.786137e-21 -3.570255e-21 -1.330112e-22
    #> [381]  6.156718e-21 -1.439054e-01  1.873091e-22 -4.249837e-21 -1.273017e-21
    #> [386]  3.708790e-21  3.785928e-21  3.561825e-21  3.682824e-23  8.218097e-21
    #> [391]  1.782174e-21 -4.005686e-22 -2.205044e-21 -1.247036e-21  4.367669e-22
    #> [396] -4.737531e-21 -5.367358e-21  9.817124e-22 -6.951409e-22  1.323278e-21

    ## Finding Projection Direction using best step size

    Direction.est <- FIHR::Direction_searchtuning(X,loading=c(1,rep(0,(p-1))))
    #> [1] 3
    Direction.est$proj
    #>   [1]  8.831247e-01  2.693877e-21 -7.687154e-22 -3.976043e-02  2.725699e-21
    #>   [6]  1.934650e-21  2.003699e-21 -6.266126e-21 -5.750624e-21  5.094255e-05
    #>  [11] -2.297243e-22 -6.367303e-21 -1.300777e-02 -1.523910e-21  2.275629e-02
    #>  [16] -2.840703e-21  2.748361e-21  1.667975e-21  1.088787e-01  6.171147e-21
    #>  [21] -4.519494e-21  7.281644e-02  4.364948e-23 -5.370140e-02  1.793074e-22
    #>  [26] -1.826824e-21 -6.000701e-21  4.536306e-21  3.328644e-21 -4.093971e-21
    #>  [31] -2.926104e-02  3.795398e-21 -6.312302e-03 -1.445562e-21 -5.915778e-22
    #>  [36] -7.538898e-22 -3.699515e-21 -1.721351e-21 -6.509072e-21  3.352522e-21
    #>  [41] -3.009878e-21 -5.188825e-21 -6.544528e-22  2.605031e-21  6.443524e-21
    #>  [46] -4.869812e-21  7.259204e-21 -2.646675e-22  8.006205e-21 -3.251789e-02
    #>  [51]  2.972782e-21  1.707459e-21 -5.220238e-21 -7.162729e-03  4.502985e-21
    #>  [56] -1.313978e-21  1.450734e-21 -3.070463e-21  1.581678e-21 -3.329087e-21
    #>  [61]  8.045162e-21  2.757945e-21  2.300074e-21  3.848543e-21  1.184367e-02
    #>  [66]  3.228540e-21 -6.543672e-21  3.310406e-21 -2.982017e-21 -4.831230e-21
    #>  [71]  1.201546e-21 -5.952655e-21  4.095763e-21 -6.892908e-21 -7.325532e-21
    #>  [76]  8.075617e-22  1.344000e-02 -1.282691e-21  5.367185e-02  4.198382e-21
    #>  [81]  2.682653e-21 -9.703846e-22 -3.378444e-21 -3.528456e-21 -1.930384e-21
    #>  [86] -1.847686e-02  5.396719e-22 -2.397832e-21  8.939924e-22 -4.747684e-21
    #>  [91] -3.313082e-21 -3.760489e-22  4.967001e-02  4.567363e-22 -3.031234e-21
    #>  [96]  1.158332e-21 -4.961619e-21  2.847377e-02  2.041095e-21 -4.128560e-21
    #> [101]  2.208152e-21  4.016148e-21  3.476573e-03 -1.609732e-21 -7.756271e-22
    #> [106]  4.080456e-21 -5.026347e-21  8.036601e-21 -1.341291e-01  7.993759e-22
    #> [111]  7.320105e-21  5.040549e-21  2.803044e-21  2.375349e-22  7.296057e-22
    #> [116]  1.931194e-21 -2.736768e-21 -1.014337e-21  2.287886e-21  5.489992e-21
    #> [121] -3.199023e-21  4.958963e-22  1.112106e-22  3.890244e-21  3.484516e-21
    #> [126] -8.377243e-21 -1.746508e-21  1.571411e-21  5.146429e-21  2.383010e-21
    #> [131]  2.436461e-22 -1.438851e-21  5.908527e-21 -5.579060e-21 -2.805317e-21
    #> [136] -4.783872e-21 -1.534559e-03  4.640352e-21 -2.386941e-21 -9.185671e-23
    #> [141] -1.986491e-21  5.885621e-21  5.354009e-21  2.735550e-21  2.869522e-21
    #> [146] -4.700133e-21 -4.768331e-21 -6.618022e-22 -1.434326e-21 -2.022068e-02
    #> [151] -2.014100e-21 -2.243887e-21 -2.281728e-22  3.802220e-21  6.582387e-22
    #> [156] -1.092528e-21 -2.856120e-21  1.689777e-21 -3.198220e-22 -7.137096e-22
    #> [161] -1.142276e-21  5.116370e-21  2.235173e-21 -5.173336e-22 -5.184859e-21
    #> [166]  1.537311e-21  8.191309e-21  4.226288e-21 -1.237475e-21  5.992227e-21
    #> [171]  1.305243e-21 -5.737715e-21 -2.128472e-21  8.274050e-21 -9.285826e-22
    #> [176] -2.984908e-21 -7.242824e-21 -3.868126e-21 -5.106236e-22 -2.245760e-21
    #> [181] -3.116912e-21  3.847713e-21 -2.774863e-21  8.043232e-02  2.574359e-02
    #> [186] -5.618123e-22  1.796404e-21 -1.715937e-21  5.297474e-21 -1.191155e-01
    #> [191]  6.051030e-21 -3.273376e-21  1.066295e-20  5.428019e-21  4.135381e-22
    #> [196] -2.189443e-21 -4.546060e-21 -1.741937e-21  1.833367e-22  3.267327e-21
    #> [201] -5.094098e-22 -4.038868e-21  1.189177e-21 -1.153712e-21 -6.608363e-21
    #> [206]  1.879556e-21 -1.663712e-21 -6.619678e-21  6.916631e-22 -1.973263e-21
    #> [211]  8.866991e-21  1.357428e-02 -3.641236e-22 -4.369490e-21 -1.899367e-21
    #> [216] -4.356545e-21  3.233552e-22  3.994225e-21  8.194470e-22 -5.140464e-21
    #> [221]  6.222684e-21 -9.725091e-21  4.876276e-21  5.368062e-02 -1.121033e-01
    #> [226] -1.691075e-21 -3.496225e-21  5.934896e-21  4.074258e-21  3.971030e-21
    #> [231] -7.805834e-21  1.417301e-21  4.728309e-21  5.168210e-21 -2.148554e-21
    #> [236]  9.927255e-21 -2.630022e-21 -8.209022e-21 -9.365642e-22  3.580409e-21
    #> [241]  2.433063e-02  6.182620e-22 -2.365139e-21 -3.721798e-21 -1.403667e-21
    #> [246] -1.762433e-21  7.268101e-21 -2.317076e-21 -4.061140e-21 -4.674868e-21
    #> [251] -4.392263e-21 -1.525856e-21 -3.248718e-21 -1.220911e-02 -8.050731e-22
    #> [256]  7.185500e-22  9.288908e-22 -1.274514e-21 -1.986562e-21  1.014238e-21
    #> [261] -7.728595e-21 -3.337141e-21 -4.564312e-02 -1.067876e-21  1.442209e-21
    #> [266] -2.868311e-21 -2.454707e-21  7.791265e-22  6.383441e-03  1.243391e-01
    #> [271]  2.489163e-21  2.479979e-21 -1.035890e-21  1.969748e-21 -3.189865e-21
    #> [276] -3.665557e-21  5.111227e-21 -1.879998e-21  4.399088e-21  6.655029e-03
    #> [281] -1.834057e-21  1.126967e-22 -7.214233e-22  3.642974e-22 -1.687909e-21
    #> [286]  2.992686e-21  5.092477e-21  6.537099e-22  1.757460e-21  4.883646e-21
    #> [291]  6.296275e-21 -4.020274e-21  3.201680e-21 -1.317465e-21  2.370940e-21
    #> [296]  3.134106e-21 -5.258918e-02  2.595644e-21  1.067645e-02  1.272909e-21
    #> [301] -8.800956e-23 -3.531421e-21  3.129455e-02  3.570893e-21  1.430819e-21
    #> [306] -5.034035e-21  2.464710e-23  5.721090e-22  1.498476e-02  1.368700e-21
    #> [311] -1.043046e-21 -4.342925e-22 -2.684153e-21  9.297160e-22 -1.107875e-21
    #> [316]  1.919482e-23  2.989166e-21  1.439536e-21 -7.594893e-21 -2.564409e-21
    #> [321]  6.458528e-21  2.477712e-21  4.162766e-21  3.973251e-21  2.184582e-21
    #> [326]  5.645134e-21  1.430106e-21  3.236379e-21 -2.348851e-21  3.028107e-21
    #> [331] -9.431286e-22  5.839980e-21  3.375432e-21  4.464952e-21  5.247299e-02
    #> [336]  3.551546e-22 -7.243694e-21 -1.973127e-21 -3.414948e-21  2.842729e-21
    #> [341]  2.094868e-21  2.119621e-22  9.218156e-21  1.076985e-02 -6.420442e-21
    #> [346]  5.150598e-22  4.530042e-21 -8.769624e-21 -7.689831e-02  4.005193e-22
    #> [351]  8.411530e-21 -5.124577e-21 -1.734944e-21  5.797675e-21 -8.255874e-03
    #> [356]  2.426683e-21  6.238281e-22 -1.369773e-21  1.625934e-21  2.375679e-21
    #> [361]  2.870532e-22 -3.457472e-22 -2.971485e-24  6.157232e-03 -4.966922e-21
    #> [366]  2.905768e-21 -1.605681e-21 -4.473964e-21 -5.733083e-21  1.275803e-02
    #> [371]  1.032696e-21  4.003003e-02  7.304228e-21 -9.869518e-22 -3.291509e-21
    #> [376] -1.312816e-02 -2.027758e-21 -6.823611e-21 -3.539434e-21 -1.803387e-22
    #> [381]  6.214708e-21 -1.439054e-01  1.439311e-22 -4.302217e-21 -1.336985e-21
    #> [386]  3.705129e-21  3.796263e-21  3.561913e-21  6.163786e-23  8.275808e-21
    #> [391]  1.770784e-21 -4.108622e-22 -2.150644e-21 -1.275889e-21  4.774950e-22
    #> [396] -4.799101e-21 -5.396399e-21  9.540132e-22 -6.886795e-22  1.376533e-21

Finding projection direction in high dimensional logistic regression


    n = 50
    p = 400
    X = matrix(sample(-2:2,n*p,replace = TRUE),nrow=n,ncol=p)
    y = rbinom(n,1,0.5)
    col.norm <- 1/sqrt((1/n)*diag(t(X)%*%X)+0.0001);
    Xnor <- X %*% diag(col.norm);
    fit = glmnet::cv.glmnet(Xnor, y, alpha=1,family = "binomial")
    htheta <- as.vector(coef(fit, s = "lambda.min"))
    support<-(abs(htheta)>0.001)
    Xb <- cbind(rep(1,n),Xnor);
    Xc <- cbind(rep(1,n),X);
    col.norm <- c(1,col.norm);
    pp <- (p+1);
    xnew = c(1,rep(0,(p-1)))
    loading=rep(0,pp)
    loading[1]=1
    loading[-1]=xnew
    htheta <- htheta*col.norm;
    htheta <- as.vector(htheta)
    f_prime <- exp(Xc%*%htheta)/(1+exp(Xc%*%htheta))^2

    ## Finding Projection Direction using fixed tuning parameter

    Direction.est <- FIHR::Direction_fixedtuning(X,loading=c(1,rep(0,(p-1))),mu=sqrt(2.01*log(p)/n)*resol^{-(step-1)},model = "logistic",weight = 1/f_prime, deriv.vec = f_prime)
    #> [1] "fixed mu"
    #> [1] 0.2181208
    Direction.est$proj
    #> numeric(0)

    ## Finding Projection Direction using best step size

    Direction.est <- FIHR::Direction_searchtuning(Xc,loading,model = "logistic",weight = 1/f_prime, deriv.vec = f_prime)
    #> [1] 2
    Direction.est$proj
    #>   [1]  4.112044e-01  3.225785e-01  6.526151e-23 -1.733840e-22 -1.190592e-22
    #>   [6]  3.053544e-22 -2.081744e-22 -1.452273e-23  4.078175e-22  2.480475e-22
    #>  [11]  9.888763e-23  1.170178e-22  3.713891e-22 -6.406519e-23  4.357658e-23
    #>  [16]  4.091253e-22 -3.378641e-22  2.053334e-22 -2.373937e-22 -2.906637e-22
    #>  [21]  2.069299e-22  1.176951e-22  1.196152e-22 -2.075734e-22  1.058289e-22
    #>  [26]  5.621870e-22 -1.497311e-22  3.340461e-22  2.101118e-22  1.536698e-22
    #>  [31]  1.184040e-22 -2.829333e-22  4.157196e-22  1.670674e-22 -1.410410e-22
    #>  [36] -5.556796e-22 -3.984815e-23 -2.260976e-22 -4.694623e-23  9.671616e-23
    #>  [41]  2.764718e-22 -4.257060e-23 -3.160195e-22  1.314551e-22  3.922965e-22
    #>  [46] -4.061418e-23 -6.713695e-23  1.313939e-22 -1.638449e-22 -4.306226e-22
    #>  [51]  4.665452e-23  2.029363e-22  1.922032e-24  8.242536e-24 -2.580824e-22
    #>  [56] -1.787148e-23 -1.651789e-22  1.539901e-22  3.297101e-23 -3.222345e-22
    #>  [61] -1.053140e-23 -1.084577e-22  3.719433e-22 -1.705167e-22 -7.408079e-23
    #>  [66]  3.673310e-22  9.621596e-23  2.029322e-22 -2.973275e-22  2.053778e-22
    #>  [71]  2.534070e-22 -3.616274e-22  1.290029e-22 -3.989856e-23  1.904342e-23
    #>  [76]  2.306431e-22 -3.404070e-22  1.054104e-22  5.378109e-23  1.014536e-22
    #>  [81] -4.758597e-23  6.989169e-23  8.181367e-23  2.015566e-22  3.393450e-23
    #>  [86] -3.022068e-22 -2.858488e-23  6.242163e-22 -7.217299e-23 -4.912491e-22
    #>  [91]  1.378773e-22  1.477645e-22  1.592233e-22  1.770715e-22  4.431497e-22
    #>  [96] -3.220581e-22 -1.170973e-22  1.525759e-22  1.099305e-22  3.948333e-22
    #> [101] -3.956867e-22 -1.647671e-22 -4.114454e-22  1.956256e-22 -2.227139e-22
    #> [106]  1.677125e-22  2.648309e-22 -1.457631e-22  2.675558e-22 -1.400335e-23
    #> [111]  1.720807e-22  5.456250e-22  6.249072e-22 -3.744605e-22 -4.128606e-22
    #> [116] -5.426350e-22 -1.940734e-22 -4.327031e-23  1.203040e-22 -5.107607e-23
    #> [121]  2.885887e-22 -2.104115e-22  1.813130e-22  2.230499e-22 -4.216898e-22
    #> [126] -6.180529e-23 -3.152707e-22  5.225949e-23  4.475580e-23 -2.719292e-23
    #> [131] -1.544149e-22  1.941358e-23  2.359402e-22  4.643883e-22  3.477736e-22
    #> [136]  3.293686e-22  1.167620e-22  2.383201e-22 -3.127990e-23  4.687719e-22
    #> [141] -9.955156e-23  4.927024e-22 -6.191175e-23 -3.192083e-22 -1.852889e-22
    #> [146]  1.367175e-22  1.622478e-22  1.454823e-22  4.586844e-22 -4.641693e-22
    #> [151]  3.214578e-22 -3.840202e-22 -1.084844e-22  2.482039e-23  1.307599e-23
    #> [156]  5.127164e-22  3.928337e-22 -1.014207e-22  3.389923e-22 -2.638509e-23
    #> [161]  3.809433e-22  5.013076e-22  1.292407e-22 -9.967221e-24 -2.469973e-22
    #> [166] -6.156186e-23  2.346331e-22  2.132440e-22  9.213179e-23  2.355838e-22
    #> [171] -3.435367e-22  3.174157e-22 -2.831995e-22  1.058442e-22  3.688278e-22
    #> [176]  2.435033e-22 -1.990783e-22  7.857649e-23  3.802123e-22 -2.877820e-23
    #> [181] -4.816294e-22  6.016095e-22 -1.212170e-22  4.319657e-24 -3.234231e-22
    #> [186] -5.160474e-22 -4.287858e-22  2.988169e-22  2.712185e-22 -3.084266e-23
    #> [191] -6.507702e-23 -7.930622e-23  3.172984e-23  4.185678e-23 -2.701264e-22
    #> [196] -2.107522e-22  4.671841e-22 -2.604659e-25  3.496306e-22  2.355252e-23
    #> [201]  4.456689e-23 -1.993283e-22  1.686363e-22 -1.013226e-22  3.038987e-22
    #> [206] -3.046908e-23  5.250005e-22  2.029563e-22  1.365760e-23 -2.408138e-22
    #> [211] -1.570135e-22  1.980426e-22 -2.215677e-22  2.194787e-22  2.808300e-22
    #> [216]  9.265100e-24 -3.335672e-22 -8.068086e-23  3.465673e-22 -2.304904e-22
    #> [221]  5.419149e-23 -9.334513e-23  2.813576e-22 -4.837853e-23 -8.774884e-23
    #> [226] -3.403628e-22  2.805328e-22  1.480964e-22 -2.266544e-22  1.193615e-22
    #> [231] -5.355487e-23  4.332865e-22 -1.309072e-22 -2.120461e-22  3.127638e-22
    #> [236]  4.961992e-22 -3.472053e-23 -1.062944e-22  1.275852e-22  1.507109e-22
    #> [241]  1.452739e-22 -8.251805e-22  4.654163e-22 -1.031601e-22  6.570933e-23
    #> [246]  2.154657e-22  5.608135e-23  3.415519e-02  1.062290e-22 -6.259023e-22
    #> [251] -1.371592e-22 -3.068091e-22  3.855044e-23 -2.315860e-22  7.405875e-23
    #> [256] -2.134412e-22 -5.598698e-23 -6.572914e-23  6.966088e-23 -4.750192e-22
    #> [261] -1.192459e-22  1.879979e-22 -3.248326e-22  1.368805e-22  1.401779e-22
    #> [266]  8.077969e-23 -3.909997e-22  7.280711e-23  5.804946e-23 -3.146217e-23
    #> [271]  2.283146e-23  2.489696e-22  1.599017e-22  1.701062e-22  2.731183e-22
    #> [276]  3.911590e-22 -1.473729e-22 -3.191629e-22 -1.693150e-22 -2.555334e-23
    #> [281]  3.741908e-22 -1.018806e-22  1.562234e-22  7.234916e-22 -1.710762e-22
    #> [286]  2.723557e-22 -1.034911e-22  1.458533e-22  5.309604e-23  1.895881e-22
    #> [291] -1.330114e-22  2.941233e-22  3.781756e-22 -6.542771e-23 -3.200018e-22
    #> [296] -3.743642e-22  5.343104e-23 -4.075303e-22 -3.826615e-22  1.225289e-22
    #> [301] -4.610328e-22  2.614043e-22  9.246957e-23 -2.248802e-22  7.216901e-23
    #> [306] -3.477539e-22  4.391526e-22  3.716418e-22 -3.066048e-22  6.753023e-23
    #> [311]  9.926581e-23  3.072567e-22  4.745392e-22 -1.622618e-22 -3.516958e-22
    #> [316] -4.036730e-22  6.198897e-24 -3.787097e-23  6.679478e-23 -1.804067e-22
    #> [321] -2.719227e-23 -5.280894e-22  2.776345e-22 -2.316126e-22  8.616079e-23
    #> [326] -5.096691e-22 -5.972876e-23  4.645829e-23  5.739552e-22 -2.026663e-22
    #> [331] -2.524421e-22  2.909004e-22  5.393645e-22  6.733250e-23  2.366643e-22
    #> [336] -1.576348e-22 -2.413007e-22  1.261417e-23  6.191240e-23 -1.001850e-22
    #> [341]  5.543842e-23  1.941893e-23  1.133189e-22  3.445938e-22 -1.009577e-22
    #> [346] -1.466317e-22  1.291309e-22  3.756745e-22 -7.267500e-23  1.121987e-22
    #> [351] -1.458974e-22 -3.306491e-22 -2.144805e-22 -3.236183e-22 -1.951750e-22
    #> [356]  1.796030e-22  1.228867e-22  1.568558e-22 -4.125925e-22  1.916495e-22
    #> [361] -8.272629e-23 -1.015723e-22  8.158407e-23  1.752711e-22  7.873224e-23
    #> [366]  8.961145e-23 -2.281047e-22  1.255392e-22 -3.264192e-22  1.381600e-22
    #> [371]  2.245289e-22  1.140814e-22 -3.748130e-22 -4.056818e-22  4.698712e-22
    #> [376] -1.949053e-22  3.066013e-22 -2.631627e-22 -3.809164e-22 -6.184673e-23
    #> [381]  1.291014e-22  9.241916e-23  5.496431e-23  3.283136e-23 -5.639188e-22
    #> [386]  3.519324e-22 -2.012022e-22  1.103543e-22  4.887579e-22 -5.389762e-22
    #> [391]  2.922822e-22 -4.482305e-23  4.923680e-23  3.351213e-22 -3.258862e-22
    #> [396]  6.071135e-22 -9.045918e-23 -2.843994e-22 -1.454969e-22 -1.848618e-22
    #> [401]  2.267113e-23

Inference for difference of linear functionals in high dimensional
linear regression

    n1 = 100
    p = 400
    n2 = 150
    A1gen <- function(rho,p){
    A1=matrix(0,p,p)
    for(i in 1:p){
    for(j in 1:p){
      A1[i,j]<-rho^(abs(i-j))
    }
    }
    A1
    }
    mu <- rep(0,p)
    mu[1:5] <- c(1:5)/5
    rho = 0.5
    Cov <- (A1gen(rho,p))/2
    Cov2<-matrix(NA,nrow=p,ncol=p)
    for(i in 1:p){
    for(j in 1:p){
      Cov2[i,j]<-0.5^(1+abs(i-j))
    }
    }
    beta1 <- rep(0,p)
    beta1[1:10] <- c(1:10)/5
    beta2 <- rep(0,p)
    beta2[1:5] <- c(1:5)/10
    X1 <- MASS::mvrnorm(n1,mu,Cov)
    X2 <- MASS::mvrnorm(n2,mu,Cov)
    y1 = X1%*%beta1 + rnorm(n1)
    y2 = X2%*%beta2 + rnorm(n2)
    loading <- MASS::mvrnorm(1,rep(0,p),Cov2)
    Est <- FIHR::ITE(X1 = X1, y1 = y1, X2 = X2, y2 = y2,loading = loading, intercept = TRUE)
    #> [1] 3
    #> [1] 3
    #> [1] 3
    #> [1] "step is 3"
    #> [1] "fixed mu"
    #> [1] 0.1542668
    #> [1] 3
    #> [1] 3
    #> [1] 3
    #> [1] "step is 3"
    #> [1] "fixed mu"
    #> [1] 0.1259583
    Est$prop.est
    #>         [,1]
    #> [1,] 1.44584
    Est$se
    #> [1] 2.889773

Inference for difference of case probabilities in high dimensional
logistic regression

    A1gen <- function(rho,p){
    A1=matrix(0,p,p)
    for(i in 1:p){
     for(j in 1:p){
       A1[i,j]<-rho^(abs(i-j))
     }
    }
    A1
    }
    n1 = 100
    n2 = 200
    p = 400
    mu <- rep(0,p)
    rho = 0.5
    Cov <- (A1gen(rho,p))/2
    Cov2<-matrix(NA,nrow=p,ncol=p)
    for(i in 1:p){
     for(j in 1:p){
       Cov2[i,j]<-0.5^(1+abs(i-j))
     }
    }

    beta1 <- rep(0,p)
    beta1[1:10] <- c(1:10)/5
    beta2 <- rep(0,p)
    beta2[1:5] <- c(1:5)/10
    X1 <- MASS::mvrnorm(n1,mu,Cov)
    X2 <- MASS::mvrnorm(n2,mu,Cov)
    exp_val1 <- X1%*%beta1
    exp_val2 <- X2%*%beta2
    prob1 <- exp(exp_val1)/(1+exp(exp_val1))
    prob2 <- exp(exp_val2)/(1+exp(exp_val2))
    y1 <- rbinom(n1,1,prob1)
    y2 <- rbinom(n2,1,prob2)
    loading <- MASS::mvrnorm(1,mu,Cov2)
    Est <- FIHR::ITE_Logistic(X1 = X1, y1 = y1, X2 = X2, y2 = y2,loading = loading, intercept = TRUE)
    #> [1] 3
    #> [1] 3
    #> [1] 3
    #> [1] "step is 3"
    #> [1] "fixed mu"
    #> [1] 0.1542668
    #> [1] "The null hypothesis claiming the case probability = 0.5, is accepted"
    #> [1] 4
    #> [1] 4
    #> [1] 3
    #> [1] "step is 4"
    #> [1] "fixed mu"
    #> [1] 0.07272207
    #> [1] "The null hypothesis claiming the case probability = 0.5, is rejected"
    Est$prop.est
    #> [1] -0.4197133
    Est$se
    #> numeric(0)
